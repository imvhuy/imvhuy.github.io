<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.147.8">
    <meta name="description" content="Build a complete weather data ETL pipeline using AWS Lambda, S3, Athena, and QuickSight">
<meta name="author" content="Dang Van Huy">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>2.2 Building the Lambda Weather Collector :: Weather ETL Pipeline with AWS</title>

    
    <link href="/css/nucleus.css?1752730352" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1752730352" rel="stylesheet">
    <link href="/css/hybrid.css?1752730352" rel="stylesheet">
    <link href="/css/featherlight.min.css?1752730352" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1752730352" rel="stylesheet">
    <link href="/css/auto-complete.css?1752730352" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1752730352" rel="stylesheet">
    <link href="/css/theme.css?1752730352" rel="stylesheet">
    <link href="/css/hugo-theme.css?1752730352" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1752730352" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1752730352"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/2-data-collection-openweathermap/2.2-lambda-weather-collector/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1752730352"></script>
<script type="text/javascript" src="/js/auto-complete.js?1752730352"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1752730352"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-introduction/" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="/1-introduction/">
          <b>1. </b>Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-data-collection-openweathermap/" title="Data Collection with OpenWeatherMap" class="dd-item 
        parent
        
        
        ">
      <a href="/2-data-collection-openweathermap/">
          <b>2. </b>Data Collection with OpenWeatherMap
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-data-collection-openweathermap/2.1-openweathermap-setup/" title="2.1 OpenWeatherMap API Setup" class="dd-item 
        
        
        
        ">
      <a href="/2-data-collection-openweathermap/2.1-openweathermap-setup/">
          2.1 OpenWeatherMap API Setup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-data-collection-openweathermap/2.2-lambda-weather-collector/" title="2.2 Building the Lambda Weather Collector" class="dd-item 
        
        active
        
        ">
      <a href="/2-data-collection-openweathermap/2.2-lambda-weather-collector/">
          2.2 Building the Lambda Weather Collector
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-data-collection-openweathermap/2.3-automated-scheduling/" title="2.3 Automated Scheduling with EventBridge" class="dd-item 
        
        
        
        ">
      <a href="/2-data-collection-openweathermap/2.3-automated-scheduling/">
          2.3 Automated Scheduling with EventBridge
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-serverless-processing-lambda/" title="Serverless Data Processing and Transformation" class="dd-item 
        
        
        
        ">
      <a href="/3-serverless-processing-lambda/">
          <b>3. </b>Serverless Data Processing and Transformation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-data-storage-solutions/" title="Data Analysis with Athena" class="dd-item 
        
        
        
        ">
      <a href="/4-data-storage-solutions/">
          <b>4. </b>Data Analysis with Athena
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-analytics-visualization/" title="Data Visualization with QuickSight" class="dd-item 
        
        
        
        ">
      <a href="/5-analytics-visualization/">
          <b>5. </b>Data Visualization with QuickSight
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6-cleanup-next-steps/" title="Resource Cleanup" class="dd-item 
        
        
        
        ">
      <a href="/6-cleanup-next-steps/">
          <b>6. </b>Resource Cleanup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/2-data-collection-openweathermap/2.2-lambda-weather-collector/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="/vi/2-data-collection-openweathermap/2.2-lambda-weather-collector/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
        <b> Workshop</b> <br> 
       <img src="https://hitwebcounter.com/counter/counter.php?page=7830891&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>17-07-2025</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Author </b> <br>
           
            <i>
                <a href="https://www.linkedin.com/in/imvhuy/"  style="color:orange">Đặng Văn Huy</a>
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Building a Serverless Weather ETL Pipeline</a> > <a href='/2-data-collection-openweathermap/'>Data Collection with OpenWeatherMap</a> > 2.2 Building the Lambda Weather Collector
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#step-1-create-iam-role-for-lambda">Step 1: Create IAM Role for Lambda</a>
      <ul>
        <li><a href="#11-create-lambda-execution-role">1.1 Create Lambda Execution Role</a></li>
        <li><a href="#12-attach-aws-managed-policies">1.2 Attach AWS Managed Policies</a></li>
      </ul>
    </li>
    <li><a href="#step-2-create-s3-bucket-for-weather-data">Step 2: Create S3 Bucket for Weather Data</a>
      <ul>
        <li><a href="#21-create-weather-data-bucket">2.1 Create Weather Data Bucket</a></li>
      </ul>
    </li>
    <li><a href="#step-3-lambda-function-for-current-weather">Step 3: Lambda Function for Current Weather</a>
      <ul>
        <li><a href="#31-create-current-weather-function">3.1 Create Current Weather Function</a></li>
        <li><a href="#32-add-function-code">3.2 Add Function Code</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              2.2 Building the Lambda Weather Collector
            </h1>
          

        



	<p>In this section, we will create AWS Lambda functions to automatically collect weather data from the OpenWeatherMap API and store it in S3. These functions will be the core of our weather data collection system.</p>
<h2 id="step-1-create-iam-role-for-lambda">Step 1: Create IAM Role for Lambda</h2>
<h3 id="11-create-lambda-execution-role">1.1 Create Lambda Execution Role</h3>
<ol>
<li>
<p><strong>Navigate to IAM Console</strong></p>
<ul>
<li>AWS Console → IAM → Roles</li>
<li>Click &ldquo;Create role&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Select Trusted Entity</strong></p>
<ul>
<li><strong>Service</strong>: Lambda</li>
<li>Click &ldquo;Next&rdquo;
<img src="/images/data-collection/22b1.png" alt="Trusted Entity"></li>
</ul>
</li>
<li>
<p><strong>Configure Role</strong></p>
<ul>
<li><strong>Role Name</strong>: <code>WeatherCollectorLambdaRole</code></li>
<li><strong>Description</strong>: <code>Execution role for weather data collection Lambda functions</code></li>
</ul>
</li>
</ol>
<h3 id="12-attach-aws-managed-policies">1.2 Attach AWS Managed Policies</h3>
<p><strong>What is an AWS Managed Policy?</strong></p>
<p>AWS has pre-created many common policies that we can attach to a Role instead of writing them from scratch. This saves time and ensures security.</p>
<p><strong>How to attach policies in the AWS Console:</strong></p>
<ol>
<li><strong>When creating the <code>WeatherCollectorLambdaRole</code></strong>, at the &ldquo;Add permissions&rdquo; step</li>
<li><strong>&ldquo;Permissions&rdquo; tab</strong> → Click &ldquo;Attach policies directly&rdquo;</li>
<li><strong>Search for and select each of the following policies:</strong>
<ul>
<li>Type <code>AWSLambdaBasicExecutionRole</code> → check the box</li>
<li>Type <code>AmazonS3FullAccess</code> → check the box</li>
<li>Type <code>AmazonSSMReadOnlyAccess</code> → check the box</li>
<li>Type <code>CloudWatchAgentServerPolicy</code> → check the box</li>
</ul>
</li>
<li><strong>Click &ldquo;Add Permissions&rdquo;</strong> and finish creating the role</li>
</ol>
<p><img src="/images/data-collection/22b11.png" alt="Managed Policies"></p>
<p><strong>Result:</strong>
The <code>WeatherCollectorLambdaRole</code> will have <strong>4 managed policies</strong>.</p>
<p><strong>This policy allows Lambda to:</strong></p>
<ul>
<li><strong>Create a CloudWatch Log Group</strong> to write logs</li>
<li><strong>Write logs to CloudWatch</strong> when the function runs</li>
<li><strong>Basic networking</strong> for Lambda to operate</li>
</ul>
<h2 id="step-2-create-s3-bucket-for-weather-data">Step 2: Create S3 Bucket for Weather Data</h2>
<h3 id="21-create-weather-data-bucket">2.1 Create Weather Data Bucket</h3>
<ol>
<li>
<p><strong>Navigate to S3 Console</strong></p>
<ul>
<li>AWS Console → S3 → Create bucket</li>
</ul>
</li>
</ol>
<p><img src="/images/data-collection/22b21.png" alt="S3"></p>
<ol start="2">
<li>
<p><strong>Configure Bucket</strong></p>
<ul>
<li><strong>Bucket Name</strong>: <code>weather-data-{your-account-id}</code> (replace with your AWS account ID)</li>
<li><strong>Region</strong>: us-east-1 (or your preferred region)</li>
<li><strong>Block Public Access</strong>: Keep all settings enabled (recommended)</li>
</ul>
</li>
</ol>
<p><img src="/images/data-collection/22b22.png" alt="res-S3"></p>
<ol start="3">
<li><strong>Bucket Structure</strong>
<pre tabindex="0"><code>weather-data-123456789012/
├── raw/
    ├── current-weather/
    │   └── year=2025/month=01/day=03/hour=10/
              └── year=2025/month=01/day=03/
</code></pre></li>
</ol>
<h2 id="step-3-lambda-function-for-current-weather">Step 3: Lambda Function for Current Weather</h2>
<h3 id="31-create-current-weather-function">3.1 Create Current Weather Function</h3>
<ol>
<li>
<p><strong>Navigate to Lambda Console</strong></p>
<ul>
<li>AWS Console → Lambda → Create function
<img src="/images/data-collection/22b31.png" alt="Lambda Console"></li>
</ul>
</li>
<li>
<p><strong>Configure Function</strong></p>
<ul>
<li><strong>Function Name</strong>: <code>weather-current-collector</code></li>
<li><strong>Runtime</strong>: Python 3.11</li>
<li><strong>Architecture</strong>: x86_64</li>
<li><strong>Execution Role</strong>: Use existing role → <code>WeatherCollectorLambdaRole</code></li>
</ul>
</li>
</ol>
<p><img src="/images/data-collection/22b32.png" alt="Create Lambda"></p>
<h3 id="32-add-function-code">3.2 Add Function Code</h3>
<p><strong>Important</strong>: Before copying the code, you need to <strong>change the API key</strong>.
In the line <code>OPENWEATHER_API_KEY = 'API Key</code><br>
→ Replace it with your API key from OpenWeatherMap</p>
<ol>
<li><strong>In the Lambda Console</strong> → Scroll down to <strong>Code source</strong></li>
<li><strong>Delete all default code</strong> in the <code>lambda_function.py</code> file</li>
<li><strong>Copy and paste the following code:</strong></li>
</ol>
<p><strong>File</strong>: <code>lambda_function.py</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> boto3
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.request
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.parse
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.error
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime, timezone
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Dict, List, Optional
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> logging
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Logging configuration</span>
</span></span><span style="display:flex;"><span>logger <span style="color:#f92672">=</span> logging<span style="color:#f92672">.</span>getLogger()
</span></span><span style="display:flex;"><span>logger<span style="color:#f92672">.</span>setLevel(logging<span style="color:#f92672">.</span>INFO)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># AWS clients with retry configuration</span>
</span></span><span style="display:flex;"><span>s3_client <span style="color:#f92672">=</span> boto3<span style="color:#f92672">.</span>client(<span style="color:#e6db74">&#39;s3&#39;</span>, config<span style="color:#f92672">=</span>boto3<span style="color:#f92672">.</span>session<span style="color:#f92672">.</span>Config(
</span></span><span style="display:flex;"><span>    retries<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;max_attempts&#39;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;mode&#39;</span>: <span style="color:#e6db74">&#39;adaptive&#39;</span>}
</span></span><span style="display:flex;"><span>))
</span></span><span style="display:flex;"><span>cloudwatch <span style="color:#f92672">=</span> boto3<span style="color:#f92672">.</span>client(<span style="color:#e6db74">&#39;cloudwatch&#39;</span>, config<span style="color:#f92672">=</span>boto3<span style="color:#f92672">.</span>session<span style="color:#f92672">.</span>Config(
</span></span><span style="display:flex;"><span>    retries<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;max_attempts&#39;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;mode&#39;</span>: <span style="color:#e6db74">&#39;adaptive&#39;</span>}
</span></span><span style="display:flex;"><span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Configuration</span>
</span></span><span style="display:flex;"><span>BUCKET_NAME <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>environ<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;WEATHER_BUCKET_NAME&#39;</span>)
</span></span><span style="display:flex;"><span>OPENWEATHER_API_KEY <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;your_api_key&#39;</span>  <span style="color:#75715e"># Replace with your actual API key</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Target cities for weather data collection</span>
</span></span><span style="display:flex;"><span>CITIES <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;HoChiMinh&#34;</span>, <span style="color:#e6db74">&#34;lat&#34;</span>: <span style="color:#ae81ff">10.7769</span>, <span style="color:#e6db74">&#34;lon&#34;</span>: <span style="color:#ae81ff">106.7009</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Hanoi&#34;</span>, <span style="color:#e6db74">&#34;lat&#34;</span>: <span style="color:#ae81ff">21.0285</span>, <span style="color:#e6db74">&#34;lon&#34;</span>: <span style="color:#ae81ff">105.8542</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Danang&#34;</span>, <span style="color:#e6db74">&#34;lat&#34;</span>: <span style="color:#ae81ff">16.0471</span>, <span style="color:#e6db74">&#34;lon&#34;</span>: <span style="color:#ae81ff">108.2068</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;GiaLai&#34;</span>, <span style="color:#e6db74">&#34;lat&#34;</span>: <span style="color:#ae81ff">13.9833</span>, <span style="color:#e6db74">&#34;lon&#34;</span>: <span style="color:#ae81ff">108.0000</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;CanTho&#34;</span>, <span style="color:#e6db74">&#34;lat&#34;</span>: <span style="color:#ae81ff">10.0452</span>, <span style="color:#e6db74">&#34;lon&#34;</span>: <span style="color:#ae81ff">105.7469</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Hue&#34;</span>, <span style="color:#e6db74">&#34;lat&#34;</span>: <span style="color:#ae81ff">16.4637</span>, <span style="color:#e6db74">&#34;lon&#34;</span>: <span style="color:#ae81ff">107.5909</span>}
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fetch_current_weather</span>(city: Dict, api_key: str) <span style="color:#f92672">-&gt;</span> Optional[Dict]:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Fetch current weather data for a city.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    base_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://api.openweathermap.org/data/2.5/weather&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    params <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;lat&#39;</span>: str(city[<span style="color:#e6db74">&#39;lat&#39;</span>]),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;lon&#39;</span>: str(city[<span style="color:#e6db74">&#39;lon&#39;</span>]),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;appid&#39;</span>: api_key,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;units&#39;</span>: <span style="color:#e6db74">&#39;metric&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;lang&#39;</span>: <span style="color:#e6db74">&#39;en&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Build URL with parameters</span>
</span></span><span style="display:flex;"><span>        query_string <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>parse<span style="color:#f92672">.</span>urlencode(params)
</span></span><span style="display:flex;"><span>        full_url <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>base_url<span style="color:#e6db74">}</span><span style="color:#e6db74">?</span><span style="color:#e6db74">{</span>query_string<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Make HTTP request</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(full_url, timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>) <span style="color:#66d9ef">as</span> response:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> response<span style="color:#f92672">.</span>status <span style="color:#f92672">!=</span> <span style="color:#ae81ff">200</span>:
</span></span><span style="display:flex;"><span>                logger<span style="color:#f92672">.</span>error(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;HTTP error </span><span style="color:#e6db74">{</span>response<span style="color:#f92672">.</span>status<span style="color:#e6db74">}</span><span style="color:#e6db74"> for </span><span style="color:#e6db74">{</span>city[<span style="color:#e6db74">&#39;name&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            response_data <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>            data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(response_data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Add metadata</span>
</span></span><span style="display:flex;"><span>        data[<span style="color:#e6db74">&#39;collection_timestamp&#39;</span>] <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>now(timezone<span style="color:#f92672">.</span>utc)<span style="color:#f92672">.</span>isoformat()
</span></span><span style="display:flex;"><span>        data[<span style="color:#e6db74">&#39;city_metadata&#39;</span>] <span style="color:#f92672">=</span> city
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> urllib<span style="color:#f92672">.</span>error<span style="color:#f92672">.</span>URLError <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>error(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;URL error for </span><span style="color:#e6db74">{</span>city[<span style="color:#e6db74">&#39;name&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> urllib<span style="color:#f92672">.</span>error<span style="color:#f92672">.</span>HTTPError <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>error(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;HTTP error for </span><span style="color:#e6db74">{</span>city[<span style="color:#e6db74">&#39;name&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> json<span style="color:#f92672">.</span>JSONDecodeError <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>error(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;JSON decode error for </span><span style="color:#e6db74">{</span>city[<span style="color:#e6db74">&#39;name&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>error(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Unexpected error for </span><span style="color:#e6db74">{</span>city[<span style="color:#e6db74">&#39;name&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">save_to_s3</span>(data: Dict, city_name: str) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Save weather data to S3.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> BUCKET_NAME:
</span></span><span style="display:flex;"><span>            logger<span style="color:#f92672">.</span>error(<span style="color:#e6db74">&#34;WEATHER_BUCKET_NAME environment variable not set&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        now <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>now(timezone<span style="color:#f92672">.</span>utc)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Create S3 key with time partitioning (Hive format for analytics)</span>
</span></span><span style="display:flex;"><span>        city_safe <span style="color:#f92672">=</span> city_name<span style="color:#f92672">.</span>lower()<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;.&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;-&#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>)
</span></span><span style="display:flex;"><span>        key <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;raw/current-weather/year=</span><span style="color:#e6db74">{</span>now<span style="color:#f92672">.</span>year<span style="color:#e6db74">}</span><span style="color:#e6db74">/month=</span><span style="color:#e6db74">{</span>now<span style="color:#f92672">.</span>month<span style="color:#e6db74">:</span><span style="color:#e6db74">02d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/day=</span><span style="color:#e6db74">{</span>now<span style="color:#f92672">.</span>day<span style="color:#e6db74">:</span><span style="color:#e6db74">02d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/hour=</span><span style="color:#e6db74">{</span>now<span style="color:#f92672">.</span>hour<span style="color:#e6db74">:</span><span style="color:#e6db74">02d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>city_safe<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">{</span>now<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y%m</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">_%H%M%S&#39;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">.json&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Prepare body data with UTF-8 encoding</span>
</span></span><span style="display:flex;"><span>        json_data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(data, ensure_ascii<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, indent<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>        body_bytes <span style="color:#f92672">=</span> json_data<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Upload file with optimized S3 parameters</span>
</span></span><span style="display:flex;"><span>        s3_client<span style="color:#f92672">.</span>put_object(
</span></span><span style="display:flex;"><span>            Bucket<span style="color:#f92672">=</span>BUCKET_NAME,
</span></span><span style="display:flex;"><span>            Key<span style="color:#f92672">=</span>key,
</span></span><span style="display:flex;"><span>            Body<span style="color:#f92672">=</span>body_bytes,
</span></span><span style="display:flex;"><span>            ContentType<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;application/json; charset=utf-8&#39;</span>,
</span></span><span style="display:flex;"><span>            ContentEncoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;utf-8&#39;</span>,
</span></span><span style="display:flex;"><span>            Metadata<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;city&#39;</span>: city_name,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;collection-time&#39;</span>: now<span style="color:#f92672">.</span>isoformat(),
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;data-type&#39;</span>: <span style="color:#e6db74">&#39;current-weather&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;source&#39;</span>: <span style="color:#e6db74">&#39;openweathermap&#39;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            ServerSideEncryption<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;AES256&#39;</span>,  <span style="color:#75715e"># Server-side encryption</span>
</span></span><span style="display:flex;"><span>            StorageClass<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;STANDARD_IA&#39;</span>  <span style="color:#75715e"># Save 40% storage cost compared to STANDARD</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>info(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Saved data for </span><span style="color:#e6db74">{</span>city_name<span style="color:#e6db74">}</span><span style="color:#e6db74"> at s3://</span><span style="color:#e6db74">{</span>BUCKET_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>key<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>error(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;S3 save error for </span><span style="color:#e6db74">{</span>city_name<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_metrics</span>(metric_name: str, value: float, unit: str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Count&#39;</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Send custom metrics to CloudWatch.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        cloudwatch<span style="color:#f92672">.</span>put_metric_data(
</span></span><span style="display:flex;"><span>            Namespace<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Weather/ETL&#39;</span>,
</span></span><span style="display:flex;"><span>            MetricData<span style="color:#f92672">=</span>[
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;MetricName&#39;</span>: metric_name,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;Value&#39;</span>: value,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;Unit&#39;</span>: unit,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;Timestamp&#39;</span>: datetime<span style="color:#f92672">.</span>now(timezone<span style="color:#f92672">.</span>utc)
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            ]
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>error(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Metric send error </span><span style="color:#e6db74">{</span>metric_name<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div>




<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/2-data-collection-openweathermap/2.1-openweathermap-setup/" title="2.1 OpenWeatherMap API Setup"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/2-data-collection-openweathermap/2.3-automated-scheduling/" title="2.3 Automated Scheduling with EventBridge" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1752730352"></script>
    <script src="/js/perfect-scrollbar.min.js?1752730352"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1752730352"></script>
    <script src="/js/jquery.sticky.js?1752730352"></script>
    <script src="/js/featherlight.min.js?1752730352"></script>
    <script src="/js/highlight.pack.js?1752730352"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1752730352"></script>
    <script src="/js/learn.js?1752730352"></script>
    <script src="/js/hugo-learn.js?1752730352"></script>

    <link href="/mermaid/mermaid.css?1752730352" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1752730352"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
