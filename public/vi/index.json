[
{
	"uri": "//localhost:1313/vi/",
	"title": "X√¢y d·ª±ng Pipeline ETL Th·ªùi ti·∫øt Serverless",
	"tags": [],
	"description": "",
	"content": "X√¢y d·ª±ng ETL Data Pipeline cho ph√¢n t√≠ch th·ªùi ti·∫øt tr√™n AWS T·ªïng quan Workshop Trong workshop n√†y, em s·∫Ω t·∫°o m·ªôt pipeline d·ªØ li·ªáu th·ªùi ti·∫øt ƒë∆°n gi·∫£n nh∆∞ng ho√†n ch·ªânh, minh h·ªça c√°c kh√°i ni·ªám ETL c·ªët l√µi s·ª≠ d·ª•ng c√¥ng ngh·ªá serverless c·ªßa AWS.\nWorkshop n√†y tr√¨nh b√†y c√°ch x√¢y d·ª±ng m·ªôt pipeline ETL ƒë∆°n gi·∫£n s·ª≠ d·ª•ng c√¥ng ngh·ªá serverless c·ªßa AWS:\nThu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt t·ª´ OpenWeatherMap API s·ª≠ d·ª•ng AWS Lambda X·ª≠ l√Ω v√† chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu th√¥ th√†nh ƒë·ªãnh d·∫°ng ph√¢n t√≠ch L∆∞u tr·ªØ d·ªØ li·ªáu trong Amazon S3 cho c·∫£ d·ªØ li·ªáu th√¥ v√† ƒë√£ x·ª≠ l√Ω Ph√¢n t√≠ch d·ªØ li·ªáu s·ª≠ d·ª•ng Amazon Athena v·ªõi truy v·∫•n SQL Tr·ª±c quan h√≥a insights th√¥ng qua Amazon QuickSight dashboard D·ªçn d·∫πp t√†i nguy√™n ƒë·ªÉ t·ªëi ∆∞u chi ph√≠ C√¥ng ngh·ªá s·ª≠ d·ª•ng: Workshop s·ª≠ d·ª•ng AWS Lambda, S3, Athena, QuickSight k·∫øt h·ª£p v·ªõi OpenWeatherMap API ƒë·ªÉ x√¢y d·ª±ng pipeline ETL serverless thu th·∫≠p v√† ph√¢n t√≠ch d·ªØ li·ªáu th·ªùi ti·∫øt. C√°c ph·∫ßn ch√≠nh 1. Gi·ªõi thi·ªáu T·ªïng quan workshop v√† m·ª•c ti√™u h·ªçc t·∫≠p Thi·∫øt k·∫ø ki·∫øn tr√∫c v√† gi·ªõi thi·ªáu c√°c d·ªãch v·ª• AWS Y√™u c·∫ßu ti√™n quy·∫øt v√† thi·∫øt l·∫≠p 2. Thu th·∫≠p D·ªØ li·ªáu Th·ªùi ti·∫øt v·ªõi OpenWeatherMap Thi·∫øt l·∫≠p t√†i kho·∫£n OpenWeatherMap API T·∫°o Lambda function cho thu th·∫≠p d·ªØ li·ªáu C·∫•u h√¨nh t·ª± ƒë·ªông l·∫•y d·ªØ li·ªáu Ki·ªÉm tra v√† gi√°m s√°t qu√° tr√¨nh thu th·∫≠p 3. X·ª≠ l√Ω D·ªØ li·ªáu Serverless v·ªõi Lambda X√¢y d·ª±ng Lambda function chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu Chuy·ªÉn ƒë·ªïi JSON th·ªùi ti·∫øt th√¥ sang ƒë·ªãnh d·∫°ng ph√¢n t√≠ch Tri·ªÉn khai x√°c th·ª±c v√† l√†m gi√†u d·ªØ li·ªáu Thi·∫øt l·∫≠p triggers x·ª≠ l√Ω 4. Ph√¢n t√≠ch D·ªØ li·ªáu v·ªõi Amazon Athena T·∫°o c·∫•u tr√∫c data lake S3 Thi·∫øt l·∫≠p b·∫£ng v√† schema Athena Vi·∫øt truy v·∫•n SQL cho ph√¢n t√≠ch th·ªùi ti·∫øt Kh√°m ph√° c√°c m·∫´u v√† th√¥ng tin chi ti·∫øt t·ª´ d·ªØ li·ªáu 5. Tr·ª±c quan h√≥a D·ªØ li·ªáu v·ªõi QuickSight Thi·∫øt l·∫≠p Amazon QuickSight T·∫°o dashboard th·ªùi ti·∫øt X√¢y d·ª±ng tr·ª±c quan h√≥a t∆∞∆°ng t√°c Chia s·∫ª v√† xu·∫•t b·∫£n dashboard 6. D·ªçn d·∫πp T√†i nguy√™n v√† B∆∞·ªõc ti·∫øp theo Danh s√°ch ki·ªÉm tra d·ªçn d·∫πp to√†n di·ªán Chi·∫øn l∆∞·ª£c t·ªëi ∆∞u chi ph√≠ ƒê·ªÅ xu·∫•t c·∫£i ti·∫øn v√† m·ªü r·ªông T√†i nguy√™n h·ªçc t·∫≠p b·ªï sung "
},
{
	"uri": "//localhost:1313/vi/2-data-collection-openweathermap/2.1-openweathermap-setup/",
	"title": "Thi·∫øt l·∫≠p OpenWeatherMap API",
	"tags": [],
	"description": "",
	"content": "Thi·∫øt l·∫≠p OpenWeatherMap API Trong ph·∫ßn ƒë∆°n gi·∫£n h√≥a n√†y, ch√∫ng ta s·∫Ω nhanh ch√≥ng thi·∫øt l·∫≠p t√†i kho·∫£n OpenWeatherMap API ƒë·ªÉ thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt cho pipeline c·ªßa ch√∫ng ta.\nB∆∞·ªõc 1: ƒêƒÉng k√Ω OpenWeatherMap T·∫°o t√†i kho·∫£n Truy c·∫≠p https://openweathermap.org v√† nh·∫•p v√†o \u0026ldquo;Sign Up\u0026rdquo; Ho√†n th√†nh ƒëƒÉng k√Ω v·ªõi email c·ªßa b·∫°n X√°c minh email v√† ƒëƒÉng nh·∫≠p B∆∞·ªõc 2: L·∫•y API Key Truy c·∫≠p API Keys Sau khi ƒëƒÉng nh·∫≠p, ƒëi ƒë·∫øn ph·∫ßn \u0026ldquo;API keys\u0026rdquo; Ghi ch√∫ API key m·∫∑c ƒë·ªãnh ho·∫∑c t·∫°o key m·ªõi v·ªõi t√™n \u0026ldquo;weather-data-collection\u0026rdquo; G√≥i mi·ªÖn ph√≠ bao g·ªìm 1,000 l·ªánh g·ªçi API m·ªói ng√†y v√† 60 l·ªánh g·ªçi m·ªói ph√∫t, t·ª´ng n√†y l√† ƒë·ªß cho workshop c·ªßa t√¥i.\nB∆∞·ªõc 3: Ki·ªÉm tra API Key Ki·ªÉm tra API key c·ªßa b·∫°n b·∫±ng m·ªôt trong c√°c ph∆∞∆°ng ph√°p sau:\nPh∆∞∆°ng ph√°p tr√¨nh duy·ªát:\nhttps://api.openweathermap.org/data/2.5/weather?lat=10.7769\u0026amp;lon=106.7009\u0026amp;appid=YOUR_API_KEY Ph∆∞∆°ng ph√°p cURL:\ncurl \u0026#34;https://api.openweathermap.org/data/2.5/weather?lat=10.7769\u0026amp;lon=106.7009\u0026amp;appid=YOUR_API_KEY\u0026#34; B·∫°n s·∫Ω th·∫•y ph·∫£n h·ªìi JSON v·ªõi d·ªØ li·ªáu th·ªùi ti·∫øt hi·ªán t·∫°i c·ªßa Th√†nh ph·ªë H·ªì Ch√≠ Minh.\nC√°c API Endpoints ch√≠nh s·∫Ω s·ª≠ d·ª•ng # Th·ªùi ti·∫øt hi·ªán t·∫°i\rhttps://api.openweathermap.org/data/2.5/weather?q={city}\u0026amp;appid={API key}\r# D·ª± b√°o 5 ng√†y (kho·∫£ng th·ªùi gian 3 gi·ªù)\rhttps://api.openweathermap.org/data/2.5/forecast?q={city}\u0026amp;appid={API key} C√°c b∆∞·ªõc ti·∫øp theo V·∫≠y l√† xong! B·∫°n ƒë√£ c√≥ API key OpenWeatherMap ho·∫°t ƒë·ªông ƒë∆∞·ª£c l∆∞u tr·ªØ an to√†n trong Parameter Store. Trong ph·∫ßn ti·∫øp theo, ch√∫ng ta s·∫Ω t·∫°o m·ªôt Lambda function ƒë·ªÉ thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt.\nƒê√£ ho√†n th√†nh:\nT·∫°o t√†i kho·∫£n OpenWeatherMap L·∫•y API key L∆∞u tr·ªØ API key trong AWS Parameter Store "
},
{
	"uri": "//localhost:1313/vi/2-data-collection-openweathermap/2.2-lambda-weather-collector/",
	"title": "X√¢y d·ª±ng Lambda Weather Collector",
	"tags": [],
	"description": "",
	"content": "Trong ph·∫ßn n√†y, ch√∫ng ta s·∫Ω t·∫°o c√°c h√†m AWS Lambda ƒë·ªÉ t·ª± ƒë·ªông thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt t·ª´ OpenWeatherMap API v√† l∆∞u tr·ªØ v√†o S3. Nh·ªØng h√†m n√†y s·∫Ω l√† l√µi c·ªßa h·ªá th·ªëng thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt.\nB∆∞·ªõc 1: T·∫°o IAM Role cho Lambda 1.1 T·∫°o Lambda Execution Role ƒêi·ªÅu h∆∞·ªõng ƒë·∫øn IAM Console\nAWS Console ‚Üí IAM ‚Üí Roles Click \u0026ldquo;Create role\u0026rdquo; Ch·ªçn Trusted Entity\nService: Lambda Click \u0026ldquo;Next\u0026rdquo; C·∫•u h√¨nh Role\nRole Name: WeatherCollectorLambdaRole Description: Execution role for weather data collection Lambda functions 1.2 G·∫Øn AWS Managed Policies AWS Managed Policy l√† g√¨?\nAWS ƒë√£ t·∫°o s·∫µn nhi·ªÅu policies ph·ªï bi·∫øn m√† ch√∫ng ta c√≥ th·ªÉ \u0026ldquo;g·∫Øn\u0026rdquo; (attach) v√†o Role thay v√¨ t·ª± vi·∫øt t·ª´ ƒë·∫ßu. ƒêi·ªÅu n√†y ti·∫øt ki·ªám th·ªùi gian v√† ƒë·∫£m b·∫£o b·∫£o m·∫≠t.\nC√°ch g·∫Øn c√°c policies trong AWS Console:\nKhi t·∫°o Role WeatherCollectorLambdaRole, ·ªü b∆∞·ªõc \u0026ldquo;Add permissions\u0026rdquo; Tab \u0026ldquo;Permissions\u0026rdquo; ‚Üí Click \u0026ldquo;Attach policies directly\u0026rdquo; T√¨m ki·∫øm v√† ch·ªçn t·ª´ng policy sau: ‚úÖ G√µ AWSLambdaBasicExecutionRole ‚Üí tick ch·ªçn ‚úÖ G√µ AmazonS3FullAccess ‚Üí tick ch·ªçn ‚úÖ G√µ AmazonSSMReadOnlyAccess ‚Üí tick ch·ªçn ‚úÖ G√µ CloudWatchAgentServerPolicy ‚Üí tick ch·ªçn Click \u0026ldquo;Add Permissions\u0026rdquo; v√† ho√†n th√†nh t·∫°o role K·∫øt qu·∫£: Role WeatherCollectorLambdaRole s·∫Ω c√≥ 4 managed policies\nPolicy n√†y cho ph√©p Lambda:\nT·∫°o CloudWatch Log Group ƒë·ªÉ ghi logs Ghi logs v√†o CloudWatch khi function ch·∫°y Basic networking ƒë·ªÉ Lambda ho·∫°t ƒë·ªông B∆∞·ªõc 2: T·∫°o S3 Bucket cho D·ªØ li·ªáu Th·ªùi ti·∫øt 2.1 T·∫°o Weather Data Bucket ƒêi·ªÅu h∆∞·ªõng ƒë·∫øn S3 Console\nAWS Console ‚Üí S3 ‚Üí Create bucket C·∫•u h√¨nh Bucket\nBucket Name: weather-data-{your-account-id} (thay th·∫ø b·∫±ng AWS account ID c·ªßa b·∫°n) Region: us-east-1 (ho·∫∑c region ∆∞a th√≠ch c·ªßa b·∫°n) Block Public Access: Gi·ªØ t·∫•t c·∫£ c√†i ƒë·∫∑t ƒë∆∞·ª£c b·∫≠t (khuy·∫øn ngh·ªã) C·∫•u tr√∫c Bucket weather-data-123456789012/\r‚îú‚îÄ‚îÄ raw/\r‚îú‚îÄ‚îÄ current-weather/\r‚îÇ ‚îî‚îÄ‚îÄ year=2025/month=01/day=03/hour=10/\r‚îî‚îÄ‚îÄ year=2025/month=01/day=03/ B∆∞·ªõc 3: Lambda Function cho Current Weather 3.1 T·∫°o Current Weather Function ƒêi·ªÅu h∆∞·ªõng ƒë·∫øn Lambda Console\nAWS Console ‚Üí Lambda ‚Üí Create function C·∫•u h√¨nh Function\nFunction Name: weather-current-collector Runtime: Python 3.11 Architecture: x86_64 Execution Role: Use existing role ‚Üí WeatherCollectorLambdaRole 3.2 Th√™m Function Code Quan tr·ªçng: Tr∆∞·ªõc khi copy code, b·∫°n c·∫ßn thay ƒë·ªïi API key. ·ªû d√≤ng OPENWEATHER_API_KEY = 'API Key\n‚Üí Thay b·∫±ng API key c·ªßa b·∫°n t·ª´ OpenWeatherMap\nTrong Lambda Console ‚Üí Scroll xu·ªëng Code source X√≥a to√†n b·ªô code m·∫∑c ƒë·ªãnh trong file lambda_function.py Copy v√† paste code sau: File: lambda_function.py\nimport json import boto3 import urllib.request import urllib.parse import urllib.error import os from datetime import datetime, timezone from typing import Dict, List, Optional import logging # Logging configuration logger = logging.getLogger() logger.setLevel(logging.INFO) # AWS clients with retry configuration s3_client = boto3.client(\u0026#39;s3\u0026#39;, config=boto3.session.Config( retries={\u0026#39;max_attempts\u0026#39;: 3, \u0026#39;mode\u0026#39;: \u0026#39;adaptive\u0026#39;} )) cloudwatch = boto3.client(\u0026#39;cloudwatch\u0026#39;, config=boto3.session.Config( retries={\u0026#39;max_attempts\u0026#39;: 3, \u0026#39;mode\u0026#39;: \u0026#39;adaptive\u0026#39;} )) # Configuration BUCKET_NAME = os.environ.get(\u0026#39;WEATHER_BUCKET_NAME\u0026#39;) OPENWEATHER_API_KEY = \u0026#39;your_api_key\u0026#39; # Replace with your actual API key # Target cities for weather data collection CITIES = [ {\u0026#34;name\u0026#34;: \u0026#34;HoChiMinh\u0026#34;, \u0026#34;lat\u0026#34;: 10.7769, \u0026#34;lon\u0026#34;: 106.7009}, {\u0026#34;name\u0026#34;: \u0026#34;Hanoi\u0026#34;, \u0026#34;lat\u0026#34;: 21.0285, \u0026#34;lon\u0026#34;: 105.8542}, {\u0026#34;name\u0026#34;: \u0026#34;Danang\u0026#34;, \u0026#34;lat\u0026#34;: 16.0471, \u0026#34;lon\u0026#34;: 108.2068}, {\u0026#34;name\u0026#34;: \u0026#34;GiaLai\u0026#34;, \u0026#34;lat\u0026#34;: 13.9833, \u0026#34;lon\u0026#34;: 108.0000}, {\u0026#34;name\u0026#34;: \u0026#34;CanTho\u0026#34;, \u0026#34;lat\u0026#34;: 10.0452, \u0026#34;lon\u0026#34;: 105.7469}, {\u0026#34;name\u0026#34;: \u0026#34;Hue\u0026#34;, \u0026#34;lat\u0026#34;: 16.4637, \u0026#34;lon\u0026#34;: 107.5909} ] def fetch_current_weather(city: Dict, api_key: str) -\u0026gt; Optional[Dict]: \u0026#34;\u0026#34;\u0026#34;Fetch current weather data for a city.\u0026#34;\u0026#34;\u0026#34; base_url = \u0026#34;https://api.openweathermap.org/data/2.5/weather\u0026#34; params = { \u0026#39;lat\u0026#39;: str(city[\u0026#39;lat\u0026#39;]), \u0026#39;lon\u0026#39;: str(city[\u0026#39;lon\u0026#39;]), \u0026#39;appid\u0026#39;: api_key, \u0026#39;units\u0026#39;: \u0026#39;metric\u0026#39;, \u0026#39;lang\u0026#39;: \u0026#39;en\u0026#39; } try: # Build URL with parameters query_string = urllib.parse.urlencode(params) full_url = f\u0026#34;{base_url}?{query_string}\u0026#34; # Make HTTP request with urllib.request.urlopen(full_url, timeout=30) as response: if response.status != 200: logger.error(f\u0026#34;HTTP error {response.status} for {city[\u0026#39;name\u0026#39;]}\u0026#34;) return None response_data = response.read().decode(\u0026#39;utf-8\u0026#39;) data = json.loads(response_data) # Add metadata data[\u0026#39;collection_timestamp\u0026#39;] = datetime.now(timezone.utc).isoformat() data[\u0026#39;city_metadata\u0026#39;] = city return data except urllib.error.URLError as e: logger.error(f\u0026#34;URL error for {city[\u0026#39;name\u0026#39;]}: {e}\u0026#34;) return None except urllib.error.HTTPError as e: logger.error(f\u0026#34;HTTP error for {city[\u0026#39;name\u0026#39;]}: {e}\u0026#34;) return None except json.JSONDecodeError as e: logger.error(f\u0026#34;JSON decode error for {city[\u0026#39;name\u0026#39;]}: {e}\u0026#34;) return None except Exception as e: logger.error(f\u0026#34;Unexpected error for {city[\u0026#39;name\u0026#39;]}: {e}\u0026#34;) return None def save_to_s3(data: Dict, city_name: str) -\u0026gt; bool: \u0026#34;\u0026#34;\u0026#34;Save weather data to S3.\u0026#34;\u0026#34;\u0026#34; try: if not BUCKET_NAME: logger.error(\u0026#34;WEATHER_BUCKET_NAME environment variable not set\u0026#34;) return False now = datetime.now(timezone.utc) # Create S3 key with time partitioning (Hive format for analytics) city_safe = city_name.lower().replace(\u0026#39; \u0026#39;, \u0026#39;_\u0026#39;).replace(\u0026#39;.\u0026#39;, \u0026#39;\u0026#39;).replace(\u0026#39;-\u0026#39;, \u0026#39;_\u0026#39;) key = f\u0026#34;raw/current-weather/year={now.year}/month={now.month:02d}/day={now.day:02d}/hour={now.hour:02d}/{city_safe}_{now.strftime(\u0026#39;%Y%m%d_%H%M%S\u0026#39;)}.json\u0026#34; # Prepare body data with UTF-8 encoding json_data = json.dumps(data, ensure_ascii=False, indent=2) body_bytes = json_data.encode(\u0026#39;utf-8\u0026#39;) # Upload file with optimized S3 parameters s3_client.put_object( Bucket=BUCKET_NAME, Key=key, Body=body_bytes, ContentType=\u0026#39;application/json; charset=utf-8\u0026#39;, ContentEncoding=\u0026#39;utf-8\u0026#39;, Metadata={ \u0026#39;city\u0026#39;: city_name, \u0026#39;collection-time\u0026#39;: now.isoformat(), \u0026#39;data-type\u0026#39;: \u0026#39;current-weather\u0026#39;, \u0026#39;source\u0026#39;: \u0026#39;openweathermap\u0026#39; }, ServerSideEncryption=\u0026#39;AES256\u0026#39;, # Server-side encryption StorageClass=\u0026#39;STANDARD_IA\u0026#39; # Save 40% storage cost compared to STANDARD ) logger.info(f\u0026#34;Saved data for {city_name} at s3://{BUCKET_NAME}/{key}\u0026#34;) return True except Exception as e: logger.error(f\u0026#34;S3 save error for {city_name}: {e}\u0026#34;) return False def send_metrics(metric_name: str, value: float, unit: str = \u0026#39;Count\u0026#39;): \u0026#34;\u0026#34;\u0026#34;Send custom metrics to CloudWatch.\u0026#34;\u0026#34;\u0026#34; try: cloudwatch.put_metric_data( Namespace=\u0026#39;Weather/ETL\u0026#39;, MetricData=[ { \u0026#39;MetricName\u0026#39;: metric_name, \u0026#39;Value\u0026#39;: value, \u0026#39;Unit\u0026#39;: unit, \u0026#39;Timestamp\u0026#39;: datetime.now(timezone.utc) } ] ) except Exception as e: logger.error(f\u0026#34;Metric send error {metric_name}: {e}\u0026#34;) def lambda_handler(event, context): \u0026#34;\u0026#34;\u0026#34;Main handler for Lambda function.\u0026#34;\u0026#34;\u0026#34; logger.info(f\u0026#34;Starting weather data collection: {json.dumps(event)}\u0026#34;) # Basic validation if not BUCKET_NAME: logger.error(\u0026#34;WEATHER_BUCKET_NAME environment variable is required\u0026#34;) return { \u0026#39;statusCode\u0026#39;: 500, \u0026#39;body\u0026#39;: json.dumps({ \u0026#39;error\u0026#39;: \u0026#39;Configuration error\u0026#39;, \u0026#39;message\u0026#39;: \u0026#39;WEATHER_BUCKET_NAME environment variable not set\u0026#39; }) } successful_collections = 0 failed_collections = 0 results = [] try: # API key validation if not OPENWEATHER_API_KEY or OPENWEATHER_API_KEY == \u0026#39;your_api_key_here\u0026#39;: logger.error(\u0026#34;OpenWeatherMap API key is not configured\u0026#34;) return { \u0026#39;statusCode\u0026#39;: 500, \u0026#39;body\u0026#39;: json.dumps({ \u0026#39;error\u0026#39;: \u0026#39;Configuration error\u0026#39;, \u0026#39;message\u0026#39;: \u0026#39;OpenWeatherMap API key not set\u0026#39; }) } # Collect data for each city for city in CITIES: logger.info(f\u0026#34;Collecting data for {city[\u0026#39;name\u0026#39;]}\u0026#34;) # Fetch weather data weather_data = fetch_current_weather(city, OPENWEATHER_API_KEY) if weather_data: # Save to S3 if save_to_s3(weather_data, city[\u0026#39;name\u0026#39;]): successful_collections += 1 results.append({ \u0026#39;city\u0026#39;: city[\u0026#39;name\u0026#39;], \u0026#39;status\u0026#39;: \u0026#39;success\u0026#39;, \u0026#39;temperature\u0026#39;: weather_data.get(\u0026#39;main\u0026#39;, {}).get(\u0026#39;temp\u0026#39;), \u0026#39;description\u0026#39;: weather_data.get(\u0026#39;weather\u0026#39;, [{}])[0].get(\u0026#39;description\u0026#39;) }) else: failed_collections += 1 results.append({ \u0026#39;city\u0026#39;: city[\u0026#39;name\u0026#39;], \u0026#39;status\u0026#39;: \u0026#39;failed\u0026#39;, \u0026#39;error\u0026#39;: \u0026#39;S3 save failed\u0026#39; }) else: failed_collections += 1 results.append({ \u0026#39;city\u0026#39;: city[\u0026#39;name\u0026#39;], \u0026#39;status\u0026#39;: \u0026#39;failed\u0026#39;, \u0026#39;error\u0026#39;: \u0026#39;API fetch failed\u0026#39; }) # Send metrics (batched to save cost) if successful_collections \u0026gt; 0 or failed_collections \u0026gt; 0: try: cloudwatch.put_metric_data( Namespace=\u0026#39;Weather/ETL\u0026#39;, MetricData=[ { \u0026#39;MetricName\u0026#39;: \u0026#39;SuccessfulCollections\u0026#39;, \u0026#39;Value\u0026#39;: successful_collections, \u0026#39;Unit\u0026#39;: \u0026#39;Count\u0026#39;, \u0026#39;Timestamp\u0026#39;: datetime.now(timezone.utc) }, { \u0026#39;MetricName\u0026#39;: \u0026#39;FailedCollections\u0026#39;, \u0026#39;Value\u0026#39;: failed_collections, \u0026#39;Unit\u0026#39;: \u0026#39;Count\u0026#39;, \u0026#39;Timestamp\u0026#39;: datetime.now(timezone.utc) }, { \u0026#39;MetricName\u0026#39;: \u0026#39;TotalCollections\u0026#39;, \u0026#39;Value\u0026#39;: successful_collections + failed_collections, \u0026#39;Unit\u0026#39;: \u0026#39;Count\u0026#39;, \u0026#39;Timestamp\u0026#39;: datetime.now(timezone.utc) } ] ) except Exception as e: logger.error(f\u0026#34;Metrics send error: {e}\u0026#34;) # Log results logger.info(f\u0026#34;Collection completed - Success: {successful_collections}, Failed: {failed_collections}\u0026#34;) return { \u0026#39;statusCode\u0026#39;: 200, \u0026#39;body\u0026#39;: json.dumps({ \u0026#39;message\u0026#39;: \u0026#39;Weather data collection completed\u0026#39;, \u0026#39;successful_collections\u0026#39;: successful_collections, \u0026#39;failed_collections\u0026#39;: failed_collections, \u0026#39;results\u0026#39;: results }) } except Exception as e: logger.error(f\u0026#34;Lambda handler error: {e}\u0026#34;) send_metrics(\u0026#39;LambdaErrors\u0026#39;, 1) return { \u0026#39;statusCode\u0026#39;: 500, \u0026#39;body\u0026#39;: json.dumps({ \u0026#39;error\u0026#39;: \u0026#39;Internal error\u0026#39;, \u0026#39;message\u0026#39;: str(e) }) } Gi·∫£i th√≠ch code\nImport libraries: C√°c th∆∞ vi·ªán c·∫ßn thi·∫øt cho HTTP requests, AWS services, logging C·∫•u h√¨nh API key: L∆∞u OpenWeatherMap API key (nh·ªõ thay b·∫±ng key c·ªßa b·∫°n!) Danh s√°ch th√†nh ph·ªë: 6 th√†nh ph·ªë Vi·ªát Nam v·ªõi t·ªça ƒë·ªô GPS ch√≠nh x√°c fetch_current_weather(): G·ªçi API ƒë·ªÉ l·∫•y th·ªùi ti·∫øt hi·ªán t·∫°i save_to_s3(): L∆∞u d·ªØ li·ªáu JSON v√†o S3 v·ªõi c·∫•u tr√∫c partition th√¥ng minh send_metrics(): G·ª≠i metrics t·ªõi CloudWatch ƒë·ªÉ monitoring lambda_handler(): H√†m ch√≠nh - x·ª≠ l√Ω t·ª´ng th√†nh ph·ªë v√† tr·∫£ v·ªÅ k·∫øt qu·∫£ Lu·ªìng ho·∫°t ƒë·ªông: Lambda ƒë∆∞·ª£c trigger ‚Üí Ki·ªÉm tra c·∫•u h√¨nh ‚Üí L·∫∑p qua 6 th√†nh ph·ªë ‚Üí G·ªçi API ‚Üí L∆∞u v√†o S3 ‚Üí G·ª≠i metrics ‚Üí Tr·∫£ v·ªÅ k·∫øt qu·∫£\n3.3 C·∫•u h√¨nh Environment Variables B∆∞·ªõc quan tr·ªçng: Lambda c·∫ßn bi·∫øt t√™n S3 bucket ƒë·ªÉ l∆∞u d·ªØ li·ªáu.\nTrong Lambda Console ‚Üí Configuration tab ‚Üí Environment variables Click \u0026ldquo;Edit\u0026rdquo; ‚Üí Add environment variable: Key: WEATHER_BUCKET_NAME Value: weather-data-{your-account-id} (thay {your-account-id} b·∫±ng account ID th·∫≠t) Account ID c√≥ th·ªÉ t√¨m ·ªü g√≥c ph·∫£i tr√™n AWS Console (d√£y s·ªë 12 ch·ªØ s·ªë)\n3.4 Test Lambda Function B√¢y gi·ªù h√£y test xem function ho·∫°t ƒë·ªông kh√¥ng!\nClick \u0026ldquo;Deploy\u0026rdquo; ƒë·ªÉ l∆∞u code v√† c·∫•u h√¨nh T·∫°o test event: Test tab ‚Üí Create new event Event name: manual-test Event JSON: {} (ƒë·ªÉ tr·ªëng v√¨ kh√¥ng c·∫ßn input) Click \u0026ldquo;Test\u0026rdquo; v√† ƒë·ª£i k·∫øt qu·∫£ K·∫øt qu·∫£ mong ƒë·ª£i:\n{ \u0026#34;statusCode\u0026#34;: 200, \u0026#34;body\u0026#34;: { \u0026#34;message\u0026#34;: \u0026#34;Weather data collection completed\u0026#34;, \u0026#34;successful_collections\u0026#34;: 6, \u0026#34;failed_collections\u0026#34;: 0, \u0026#34;results\u0026#34;: [ { \u0026#34;city\u0026#34;: \u0026#34;HoChiMinh\u0026#34;, \u0026#34;status\u0026#34;: \u0026#34;success\u0026#34;, \u0026#34;temperature\u0026#34;: 28.5, \u0026#34;description\u0026#34;: \u0026#34;broken clouds\u0026#34; } // ... 5 th√†nh ph·ªë kh√°c ] } } 4. Ki·ªÉm tra S3: V√†o S3 bucket v√† xem c√≥ file JSON m·ªõi kh√¥ng\nN·∫øu test th√†nh c√¥ng, b·∫°n ƒë√£ c√≥:\nLambda function ho·∫°t ƒë·ªông D·ªØ li·ªáu th·ªùi ti·∫øt ƒë∆∞·ª£c l∆∞u v√†o S3 CloudWatch metrics ƒë∆∞·ª£c g·ª≠i Error handling ho·∫°t ƒë·ªông Lambda ƒë√£ s·∫µn s√†ng ƒë·ªÉ t·ª± ƒë·ªông ch·∫°y theo schedule\nN·∫øu test th·∫•t b·∫°i, ki·ªÉm tra:\nCloudWatch Logs: Lambda ‚Üí Monitoring ‚Üí View logs ‚Üí Xem l·ªói c·ª• th·ªÉ API Key: ƒê·∫£m b·∫£o key OpenWeatherMap ƒë√∫ng Environment variable: WEATHER_BUCKET_NAME ƒë√∫ng format IAM Role: ƒê·∫£m b·∫£o role c√≥ ƒë·ªß permissions S3 Bucket: Bucket ƒë√£ ƒë∆∞·ª£c t·∫°o ch∆∞a 4.1 Test Lambda Function B√¢y gi·ªù h√£y test xem function ho·∫°t ƒë·ªông kh√¥ng!\nClick \u0026ldquo;Deploy\u0026rdquo; ƒë·ªÉ l∆∞u code v√† c·∫•u h√¨nh T·∫°o test event: Test tab ‚Üí Create new event Event name: manual-test Event JSON: {} (ƒë·ªÉ tr·ªëng v√¨ kh√¥ng c·∫ßn input) Click \u0026ldquo;Test\u0026rdquo; v√† ƒë·ª£i k·∫øt qu·∫£ K·∫øt qu·∫£ mong ƒë·ª£i:\n{ \u0026#34;statusCode\u0026#34;: 200, \u0026#34;body\u0026#34;: { \u0026#34;message\u0026#34;: \u0026#34;Weather data collection completed\u0026#34;, \u0026#34;successful_collections\u0026#34;: 6, \u0026#34;failed_collections\u0026#34;: 0, \u0026#34;results\u0026#34;: [ { \u0026#34;city\u0026#34;: \u0026#34;HoChiMinh\u0026#34;, \u0026#34;status\u0026#34;: \u0026#34;success\u0026#34;, \u0026#34;temperature\u0026#34;: 28.5, \u0026#34;description\u0026#34;: \u0026#34;broken clouds\u0026#34; } // ... 5 th√†nh ph·ªë kh√°c ] } } 4. Ki·ªÉm tra S3: V√†o S3 bucket v√† xem c√≥ file JSON m·ªõi kh√¥ng\nN·∫øu test th√†nh c√¥ng, b·∫°n ƒë√£ c√≥:\nLambda function ho·∫°t ƒë·ªông D·ªØ li·ªáu th·ªùi ti·∫øt ƒë∆∞·ª£c l∆∞u v√†o S3 CloudWatch metrics ƒë∆∞·ª£c g·ª≠i Error handling ho·∫°t ƒë·ªông Lambda ƒë√£ s·∫µn s√†ng ƒë·ªÉ t·ª± ƒë·ªông ch·∫°y theo schedule\nN·∫øu test th·∫•t b·∫°i, ki·ªÉm tra:\nCloudWatch Logs: Lambda ‚Üí Monitoring ‚Üí View logs ‚Üí Xem l·ªói c·ª• th·ªÉ API Key: ƒê·∫£m b·∫£o key OpenWeatherMap ƒë√∫ng Environment variable: WEATHER_BUCKET_NAME ƒë√∫ng format IAM Role: ƒê·∫£m b·∫£o role c√≥ ƒë·ªß permissions S3 Bucket: Bucket ƒë√£ ƒë∆∞·ª£c t·∫°o ch∆∞a T√≥m t·∫Øt Trong ph·∫ßn n√†y, ch√∫ng ta ƒë√£:\n‚úÖ T·∫°o IAM roles v√† policies cho Lambda function ‚úÖ Thi·∫øt l·∫≠p S3 bucket v·ªõi c·∫•u tr√∫c partition th√¥ng minh ‚úÖ X√¢y d·ª±ng Lambda function thu th·∫≠p th·ªùi ti·∫øt hi·ªán t·∫°i ‚úÖ C·∫•u h√¨nh error handling v√† CloudWatch metrics ‚úÖ Test function th√†nh c√¥ng v·ªõi 6 th√†nh ph·ªë Vi·ªát Nam K·∫øt qu·∫£ ƒë·∫°t ƒë∆∞·ª£c:\nLambda function weather-current-collector ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh D·ªØ li·ªáu th·ªùi ti·∫øt ƒë∆∞·ª£c l∆∞u v√†o S3 v·ªõi format analytics-ready Monitoring v√† metrics ƒë·∫ßy ƒë·ªß qua CloudWatch Error handling robust v·ªõi retry mechanism Ti·∫øp theo: Trong module 2.3, ch√∫ng ta s·∫Ω thi·∫øt l·∫≠p automated scheduling v·ªõi EventBridge ƒë·ªÉ ch·∫°y function n√†y theo l·ªãch tr√¨nh t·ª± ƒë·ªông.\n"
},
{
	"uri": "//localhost:1313/vi/2-data-collection-openweathermap/2.3-automated-scheduling/",
	"title": "L·∫≠p l·ªãch T·ª± ƒë·ªông v·ªõi EventBridge",
	"tags": [],
	"description": "",
	"content": "Trong ph·∫ßn n√†y, ch√∫ng ta s·∫Ω thi·∫øt l·∫≠p l·∫≠p l·ªãch t·ª± ƒë·ªông cho vi·ªác thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt b·∫±ng Amazon EventBridge (tr∆∞·ªõc ƒë√¢y g·ªçi l√† CloudWatch Events). ƒêi·ªÅu n√†y gi√∫p c√°c Lambda functions ch·∫°y theo l·ªãch tr√¨nh ƒë·ªÅu ƒë·∫∑n m√† kh√¥ng c·∫ßn can thi·ªáp th·ªß c√¥ng.\nEventBridge gi·ªëng nh∆∞ \u0026ldquo;ƒë·ªìng h·ªì b√°o th·ª©c th√¥ng minh\u0026rdquo; c·ªßa AWS:\nCh·∫°y ƒë√∫ng gi·ªù: Trigger Lambda functions theo l·ªãch tr√¨nh c·ª• th·ªÉ Ch√≠nh x√°c: Ch·∫°y ƒë√∫ng th·ªùi gian ƒë√£ ƒë·ªãnh (v√≠ d·ª•: m·ªói gi·ªù, m·ªói ng√†y) T·ª± ƒë·ªông: Kh√¥ng c·∫ßn can thi·ªáp th·ªß c√¥ng Ti·∫øt ki·ªám: Ch·ªâ ch·∫°y khi c·∫ßn, kh√¥ng t·ªën t√†i nguy√™n khi kh√¥ng ho·∫°t ƒë·ªông T·∫°i sao c·∫ßn Scheduling?\nThu th·∫≠p d·ªØ li·ªáu ƒë·ªÅu ƒë·∫∑n 24/7 D·ªØ li·ªáu lu√¥n fresh v√† c·∫≠p nh·∫≠t T·ª± ƒë·ªông h√≥a ho√†n to√†n Kh√¥ng ph·ª• thu·ªôc v√†o ng∆∞·ªùi v·∫≠n h√†nh L·ªãch tr√¨nh ƒë·ªÅ xu·∫•t:\nCurrent Weather: M·ªói gi·ªù (24 l·∫ßn/ng√†y) - ƒê·ªÉ theo d√µi th·ªùi ti·∫øt real-time B∆∞·ªõc 1: Thi·∫øt l·∫≠p EventBridge Rule cho Current Weather B∆∞·ªõc n√†y s·∫Ω t·∫°o l·ªãch tr√¨nh ch·∫°y Lambda m·ªói gi·ªù ƒë·ªÉ thu th·∫≠p th·ªùi ti·∫øt hi·ªán t·∫°i.\nV√≠ d·ª•: Function s·∫Ω ch·∫°y l√∫c 00:00, 01:00, 02:00\u0026hellip; 23:00 h√†ng ng√†y\n1.1 Truy c·∫≠p EventBridge Console V√†o AWS Console ‚Üí T√¨m \u0026ldquo;EventBridge\u0026rdquo; (ho·∫∑c \u0026ldquo;CloudWatch\u0026rdquo; ‚Üí \u0026ldquo;Events\u0026rdquo;) Click \u0026ldquo;EventBridge\u0026rdquo; ‚Üí \u0026ldquo;Rules\u0026rdquo; ·ªü menu b√™n tr√°i Ch·ªçn Region ph√π h·ª£p (v√≠ d·ª•: us-east-1) 1.2 T·∫°o Rule cho Current Weather Click \u0026ldquo;Create rule\u0026rdquo; B∆∞·ªõc 1 - Define rule detail: Name: weather-current-hourly Description: Thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt hi·ªán t·∫°i m·ªói gi·ªù cho 6 th√†nh ph·ªë Vi·ªát Nam Event bus: default Rule type: Schedule Click \u0026ldquo;Continue to create rule\u0026rdquo; 1.3 C·∫•u h√¨nh Schedule Pattern Schedule pattern: Ch·ªçn \u0026ldquo;A schedule that runs at a regular rate, such as every 10 minutes\u0026rdquo;\nRate expression: Ch·ªçn \u0026ldquo;rate\u0026rdquo; v√† nh·∫≠p:\n1 hour C√°c l·ª±a ch·ªçn Schedule Pattern:\nRate expression:\nrate(1 hour) = m·ªói gi·ªù rate(30 minutes) = m·ªói 30 ph√∫t rate(1 day) = m·ªói ng√†y Cron expression (n√¢ng cao):\ncron(0 * * * ? *) = m·ªói gi·ªù ƒë√∫ng ph√∫t 0 cron(0 8,12,16,20 * * ? *) = 4 l·∫ßn/ng√†y (8h, 12h, 16h, 20h) cron(0 0 * * ? *) = m·ªói ng√†y l√∫c 00:00 Click \u0026ldquo;Next\u0026rdquo; 1.4 Select Target (Lambda Function) Target types: Ch·ªçn \u0026ldquo;AWS service\u0026rdquo;\nSelect a service: Ch·ªçn \u0026ldquo;Lambda function\u0026rdquo;\nFunction: Ch·ªçn weather-current-collector (function ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc)\nAdditional settings: Configure target input: Ch·ªçn \u0026ldquo;Constant (JSON text)\u0026rdquo; JSON text: { \u0026#34;source\u0026#34;: \u0026#34;eventbridge-schedule\u0026#34;, \u0026#34;detail-type\u0026#34;: \u0026#34;Scheduled Event\u0026#34;, \u0026#34;detail\u0026#34;: { \u0026#34;collection_type\u0026#34;: \u0026#34;current_weather\u0026#34;, \u0026#34;scheduled_time\u0026#34;: \u0026#34;hourly\u0026#34;, \u0026#34;trigger_source\u0026#34;: \u0026#34;eventbridge\u0026#34; } } JSON input n√†y s·∫Ω:\nCho Lambda bi·∫øt ƒë√¢y l√† scheduled event (kh√¥ng ph·∫£i manual test) Gi√∫p ph√¢n bi·ªát current weather Cung c·∫•p metadata ƒë·ªÉ logging v√† monitoring Click \u0026ldquo;Next\u0026rdquo; 1.5 Configure tags v√† Review Tags (Optional):\nKey: Project ‚Üí Value: WeatherETL Key: Environment ‚Üí Value: Production Review t·∫•t c·∫£ c√†i ƒë·∫∑t:\n‚úÖ Name: weather-current-hourly ‚úÖ Schedule: rate(1 hour) ‚úÖ Target: weather-current-collector ‚úÖ State: Enabled Click \u0026ldquo;Create rule\u0026rdquo;\nRule cho current weather ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng.\nRule s·∫Ω trigger Lambda function weather-current-collector m·ªói gi·ªù ƒë·ªÉ thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt hi·ªán t·∫°i.\nHo√†n th√†nh EventBridge Setup!\nEventBridge rule ƒë√£ ƒë∆∞·ª£c t·∫°o v√† s·∫Ω t·ª± ƒë·ªông trigger Lambda function m·ªói gi·ªù:\n‚è∞ Schedule: M·ªói gi·ªù (24 l·∫ßn/ng√†y) üéØ Target: weather-current-collector Lambda function üìä Data: Thu th·∫≠p th·ªùi ti·∫øt hi·ªán t·∫°i cho 6 th√†nh ph·ªë üîÑ Status: Enabled v√† ready to run Workflow t·ª± ƒë·ªông: EventBridge ‚Üí weather-current-collector ‚Üí S3 Storage ‚Üí CloudWatch Metrics\nB∆∞·ªõc 3: Thi·∫øt l·∫≠p Monitoring v·ªõi CloudWatch Alarms T·∫°i sao c·∫ßn Monitoring?\nKhi Lambda functions ch·∫°y t·ª± ƒë·ªông 24/7, b·∫°n c·∫ßn bi·∫øt ngay khi c√≥ v·∫•n ƒë·ªÅ:\nLambda function b·ªã l·ªói Function ch·∫°y qu√° l√¢u T·ª∑ l·ªá th√†nh c√¥ng th·∫•p Chi ph√≠ tƒÉng b·∫•t th∆∞·ªùng 3.1 T·∫°o SNS Topic cho Email Alerts Tr∆∞·ªõc ti√™n, t·∫°o SNS Topic ƒë·ªÉ nh·∫≠n email th√¥ng b√°o khi c√≥ l·ªói:\nAWS Console ‚Üí \u0026ldquo;SNS\u0026rdquo; ‚Üí \u0026ldquo;Topics\u0026rdquo; ‚Üí \u0026ldquo;Create topic\u0026rdquo; Topic configuration:\nType: Standard Name: weather-etl-alerts Display name: Weather ETL Alerts Create topic\nT·∫°o Subscription:\nProtocol: Email Endpoint: your-email@example.com (thay b·∫±ng email c·ªßa b·∫°n) Confirm subscription qua email 3.2 T·∫°o CloudWatch Alarm cho Lambda Errors AWS Console ‚Üí \u0026ldquo;CloudWatch\u0026rdquo; ‚Üí \u0026ldquo;Alarms\u0026rdquo; ‚Üí \u0026ldquo;Create alarm\u0026rdquo;\nSelect metric:\nNamespace: AWS/Lambda Metric name: Errors Dimensions: FunctionName: weather-current-collector Specify metric and conditions:\nStatistic: Sum Period: 5 minutes Threshold type: Static Condition: Greater/Equal Threshold value: 1 (alert khi c√≥ ‚â•1 error trong 5 ph√∫t) Configure actions:\nAlarm state trigger: In alarm SNS topic: weather-etl-alerts Add name and description:\nAlarm name: WeatherCurrentCollector-Errors Description: Alert khi Lambda weather-current-collector c√≥ l·ªói Create alarm Quan tr·ªçng: H√£y ƒë·∫£m b·∫£o t·∫•t c·∫£ ho·∫°t ƒë·ªông ƒë√∫ng tr∆∞·ªõc khi ƒë·ªÉ n√≥ t·ª± ƒë·ªông ch·∫°y\nT·ªëi ∆∞u h√≥a Chi ph√≠ v√† Hi·ªáu su·∫•t 1. Smart Scheduling Strategy Thay v√¨ ch·∫°y c√πng frequency 24/7, c√≥ th·ªÉ t·ªëi ∆∞u:\nGi·ªù cao ƒëi·ªÉm (6:00-23:00): M·ªói gi·ªù Gi·ªù th·∫•p ƒëi·ªÉm (23:00-6:00): M·ªói 2 gi·ªù Cu·ªëi tu·∫ßn: M·ªói 2 gi·ªù (√≠t ng∆∞·ªùi quan t√¢m th·ªùi ti·∫øt c√¥ng vi·ªác) T·∫°o multiple rules v·ªõi different schedules:\nRule 1 - Peak Hours:\ncron(0 6-23 * * ? *) Rule 2 - Off-peak Hours:\ncron(0 0,2,4 * * ? *) 2. Regional Optimization N·∫øu c·∫ßn collect data cho multiple regions:\n{ \u0026#34;source\u0026#34;: \u0026#34;eventbridge-schedule\u0026#34;, \u0026#34;detail\u0026#34;: { \u0026#34;region\u0026#34;: \u0026#34;southeast-asia\u0026#34;, \u0026#34;cities\u0026#34;: [\u0026#34;HoChiMinh\u0026#34;, \u0026#34;Hanoi\u0026#34;, \u0026#34;Bangkok\u0026#34;], \u0026#34;priority\u0026#34;: \u0026#34;high\u0026#34; } } 3. Error Recovery Strategy Th√™m Dead Letter Queue cho Lambda:\nLambda function configuration ‚Üí \u0026ldquo;Asynchronous invocation\u0026rdquo; Dead letter queue: Enable v·ªõi SQS queue Maximum age of event: 6 hours Retry attempts: 2 T√≥m t·∫Øt Trong ph·∫ßn n√†y, ch√∫ng ta ƒë√£ ho√†n th√†nh:\n‚úÖ Thi·∫øt l·∫≠p EventBridge Rule:\n‚è∞ Current weather collection: M·ªói gi·ªù (24 l·∫ßn/ng√†y) üéØ Target: weather-current-collector Lambda function üìä Thu th·∫≠p d·ªØ li·ªáu 6 th√†nh ph·ªë Vi·ªát Nam t·ª± ƒë·ªông ‚úÖ CloudWatch Monitoring:\nSNS topic cho email alerts CloudWatch alarms cho Lambda errors v√† duration Metrics tracking cho system health ‚úÖ Testing v√† Verification:\nManual testing EventBridge rules Verify S3 data collection ho·∫°t ƒë·ªông Check CloudWatch logs v√† metrics üéâ K·∫øt qu·∫£ ƒë·∫°t ƒë∆∞·ª£c:\nH·ªá th·ªëng thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt t·ª± ƒë·ªông 24/7 Monitoring v√† alerting ƒë·∫ßy ƒë·ªß Data pipeline reliable v√† scalable S·∫µn s√†ng cho data processing ·ªü Module 3 Ti·∫øp theo: Trong module 2.4, ch√∫ng ta s·∫Ω thi·∫øt l·∫≠p testing v√† validation to√†n di·ªán ƒë·ªÉ ƒë·∫£m b·∫£o data quality v√† system reliability.\n"
},
{
	"uri": "//localhost:1313/vi/1-introduction/",
	"title": "Gi·ªõi thi·ªáu",
	"tags": [],
	"description": "",
	"content": "X√¢y d·ª±ng ETL Data Pipeline cho ph√¢n t√≠ch th·ªùi ti·∫øt tr√™n AWS M·ª•c ti√™u X√¢y d·ª±ng h·ªá th·ªëng thu th·∫≠p d·ªØ li·ªáu serverless s·ª≠ d·ª•ng AWS Lambda Tri·ªÉn khai quy tr√¨nh chuy·ªÉn ƒë·ªïi v√† x·ª≠ l√Ω d·ªØ li·ªáu L∆∞u tr·ªØ v√† truy v·∫•n d·ªØ li·ªáu s·ª≠ d·ª•ng Amazon S3 v√† Athena T·∫°o tr·ª±c quan h√≥a v·ªõi Amazon QuickSight √Åp d·ª•ng c√°c best practices c·ªßa AWS cho t·ªëi ∆∞u chi ph√≠ v√† d·ªçn d·∫πp t√†i nguy√™n T·ªïng quan Ki·∫øn tr√∫c Pipeline ETL th·ªùi ti·∫øt c·ªßa ch√∫ng ta tu√¢n theo ki·∫øn tr√∫c serverless ƒë∆°n gi·∫£n n√†y: C√°c th√†nh ph·∫ßn ch√≠nh:\nNgu·ªìn d·ªØ li·ªáu: OpenWeatherMap API cho d·ªØ li·ªáu th·ªùi ti·∫øt th·ªùi gian th·ª±c Thu th·∫≠p: AWS Lambda function ƒë·ªÉ l·∫•y d·ªØ li·ªáu th·ªùi ti·∫øt L∆∞u tr·ªØ: Amazon S3 cho c·∫£ d·ªØ li·ªáu th√¥ v√† ƒë√£ x·ª≠ l√Ω X·ª≠ l√Ω: AWS Lambda cho chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu Ph√¢n t√≠ch: Amazon Athena cho truy v·∫•n SQL Tr·ª±c quan h√≥a: Amazon QuickSight cho dashboard Y√™u c·∫ßu Ti√™n quy·∫øt Tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu workshop n√†y, h√£y ƒë·∫£m b·∫£o b·∫°n c√≥:\nT√†i kho·∫£n AWS v·ªõi quy·ªÅn truy c·∫≠p qu·∫£n tr·ªã Hi·ªÉu bi·∫øt c∆° b·∫£n v·ªÅ AWS console Hi·ªÉu bi·∫øt v·ªÅ c√°c kh√°i ni·ªám l·∫≠p tr√¨nh c∆° b·∫£n T√†i kho·∫£n OpenWeatherMap (tier mi·ªÖn ph√≠ l√† ƒë·ªß, ·ªü b√†i workshop n√†y em s·ª≠ d·ª•ng Developer plan) "
},
{
	"uri": "//localhost:1313/vi/2-data-collection-openweathermap/",
	"title": "Thu th·∫≠p D·ªØ li·ªáu Th·ªùi ti·∫øt v·ªõi OpenWeatherMap",
	"tags": [],
	"description": "",
	"content": "Trong ph·∫ßn n√†y, ta s·∫Ω h·ªçc c√°ch thi·∫øt l·∫≠p thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt t·ª± ƒë·ªông b·∫±ng OpenWeatherMap API v√† AWS Lambda. ƒê√¢y l√† n·ªÅn t·∫£ng c·ªßa pipeline ETL ph√¢n t√≠ch th·ªùi ti·∫øt, n∆°i ch√∫ng ta s·∫Ω x√¢y d·ª±ng h·ªá th·ªëng thu th·∫≠p d·ªØ li·ªáu serverless ƒë√°ng tin c·∫≠y.\n2.1 OpenWeatherMap Setup Thi·∫øt l·∫≠p API v√† Credentials\nThi·∫øt l·∫≠p t√†i kho·∫£n OpenWeatherMap, l·∫•y API key, v√† c·∫•u h√¨nh Systems Manager Parameter Store ƒë·ªÉ l∆∞u tr·ªØ credentials m·ªôt c√°ch b·∫£o m·∫≠t. B·∫°n s·∫Ω h·ªçc c√°ch qu·∫£n l√Ω API keys v√† test connectivity.\n2.2 Lambda Weather Collector X√¢y d·ª±ng Functions Thu th·∫≠p D·ªØ li·ªáu\nT·∫°o c√°c Lambda functions ƒë·ªÉ thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt hi·ªán t·∫°i v√† d·ª± b√°o t·ª´ OpenWeatherMap API. Bao g·ªìm IAM roles, S3 bucket setup, v√† function code v·ªõi error handling.\n2.3 Automated Scheduling L·∫≠p l·ªãch T·ª± ƒë·ªông v·ªõi CloudWatch Events\nThi·∫øt l·∫≠p CloudWatch Events ƒë·ªÉ ch·∫°y c√°c Lambda functions theo l·ªãch tr√¨nh t·ª± ƒë·ªông. C·∫•u h√¨nh monitoring, alarms, v√† notifications ƒë·ªÉ ƒë·∫£m b·∫£o h·ªá th·ªëng ch·∫°y ·ªïn ƒë·ªãnh.\n2.4 Testing v√† Monitoring Testing v√† Monitoring To√†n di·ªán\nThi·∫øt l·∫≠p testing strategy bao g·ªìm manual testing, data quality validation, performance testing, v√† automated health checks. T·∫°o dashboard ƒë·ªÉ monitor h·ªá th·ªëng.\nKi·∫øn tr√∫c T·ªïng quan graph TD\rA[OpenWeatherMap API\u0026lt;br/\u0026gt;Current Weather Data] --\u0026gt; B[Lambda Function\u0026lt;br/\u0026gt;weather-current-collector]\rC[EventBridge Rule\u0026lt;br/\u0026gt;Every Hour] --\u0026gt; B\rB --\u0026gt; D[S3 Raw Storage\u0026lt;br/\u0026gt;current-weather/]\rB --\u0026gt; E[CloudWatch Logs\u0026lt;br/\u0026gt;Monitoring]\rB --\u0026gt; F[CloudWatch Metrics\u0026lt;br/\u0026gt;Success/Error Counts]\rG[6 Vietnamese Cities\u0026lt;br/\u0026gt;HCM, Hanoi, Danang\u0026lt;br/\u0026gt;GiaLai, CanTho, Hue] --\u0026gt; A\rstyle A fill:#e1f5fe,stroke:#01579b,stroke-width:2px\rstyle B fill:#ff9900,stroke:#232f3e,stroke-width:3px\rstyle C fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px\rstyle D fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px\rstyle E fill:#fff3e0,stroke:#ef6c00,stroke-width:2px\rstyle F fill:#e3f2fd,stroke:#1976d2,stroke-width:2px\rstyle G fill:#f1f8e9,stroke:#558b2f,stroke-width:2px Lo·∫°i D·ªØ li·ªáu Thu th·∫≠p Thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt hi·ªán t·∫°i cho 6 t·ªânh th√†nh Vi·ªát Nam:\nüèôÔ∏è Th√†nh ph·ªë ch√≠nh: H√† N·ªôi, H·ªì Ch√≠ Minh, ƒê√† N·∫µng üåæ Khu v·ª±c n√¥ng nghi·ªáp: Gia Lai, C·∫ßn Th∆° üèõÔ∏è Di s·∫£n vƒÉn h√≥a: Hu·∫ø üìä D·ªØ li·ªáu thu th·∫≠p:\nNhi·ªát ƒë·ªô (¬∞C, ¬∞F), ƒë·ªô ·∫©m, √°p su·∫•t T·ªëc ƒë·ªô gi√≥, h∆∞·ªõng gi√≥, m√¢y che ph·ªß M√¥ t·∫£ th·ªùi ti·∫øt, weather condition Metadata: timestamp, location, collection info L·ªãch tr√¨nh Thu th·∫≠p ‚è∞ Th·ªùi ti·∫øt Hi·ªán t·∫°i: M·ªói gi·ªù (24 l·∫ßn/ng√†y √ó 6 th√†nh ph·ªë = 144 data points/ng√†y)\n∆Ø·ªõc t√≠nh Chi ph√≠ D·ªãch v·ª• S·ª≠ d·ª•ng Chi ph√≠ OpenWeatherMap API 144 calls/ng√†y Free Lambda Executions 720 invocations/th√°ng Free Tier S3 Storage 500 MB d·ªØ li·ªáu Free Tier CloudWatch Logs 2 GB logs $1.00 T·ªïng ~$1.00/th√°ng OpenWeatherMap cung c·∫•p 1,000 l·ªùi g·ªçi API mi·ªÖn ph√≠ m·ªói ng√†y, ƒë·ªß cho workshop n√†y.\nK·∫øt qu·∫£ Mong ƒë·ª£i Sau khi ho√†n th√†nh module n√†y, b·∫°n s·∫Ω c√≥:\nH·ªá th·ªëng thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt serverless ho·∫°t ƒë·ªông 24/7 D·ªØ li·ªáu th·ªùi ti·∫øt ƒë∆∞·ª£c l∆∞u tr·ªØ c√≥ c·∫•u tr√∫c trong S3 Monitoring v√† alerting system ƒë·∫ßy ƒë·ªß Ki·∫øn th·ª©c v·ªÅ AWS Lambda, CloudWatch Events, v√† S3 integration B·∫Øt ƒë·∫ßu S·∫µn s√†ng x√¢y d·ª±ng h·ªá th·ªëng thu th·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt? B·∫Øt ƒë·∫ßu v·ªõi 2.1 OpenWeatherMap Setup ƒë·ªÉ thi·∫øt l·∫≠p API v√† credentials.\n"
},
{
	"uri": "//localhost:1313/vi/3-serverless-processing-lambda/",
	"title": "X·ª≠ l√Ω v√† Chuy·ªÉn ƒë·ªïi D·ªØ li·ªáu Serverless",
	"tags": [],
	"description": "",
	"content": "Trong module n√†y, ch√∫ng ta s·∫Ω x√¢y d·ª±ng Lambda functions ƒë·ªÉ x·ª≠ l√Ω v√† chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu th·ªùi ti·∫øt th√¥ t·ª´ module 2 th√†nh ƒë·ªãnh d·∫°ng ph√π h·ª£p cho ph√¢n t√≠ch. ƒê√¢y l√† b∆∞·ªõc \u0026ldquo;Transform\u0026rdquo; trong pipeline ETL, gi√∫p l√†m s·∫°ch, chu·∫©n h√≥a v√† t·∫°o ra c√°c metrics c√≥ √Ω nghƒ©a t·ª´ d·ªØ li·ªáu th√¥.\nD·ªØ li·ªáu th√¥ t·ª´ OpenWeatherMap API c√≥ nhi·ªÅu v·∫•n ƒë·ªÅ:\nC·∫•u tr√∫c ph·ª©c t·∫°p: Nested JSON kh√≥ query ƒê∆°n v·ªã kh√¥ng th·ªëng nh·∫•t: Kelvin, m/s, Pascal\u0026hellip; D·ªØ li·ªáu d∆∞ th·ª´a: Nhi·ªÅu fields kh√¥ng c·∫ßn thi·∫øt Thi·∫øu insights: Kh√¥ng c√≥ derived metrics V√¨ v·∫≠y c·∫ßn ph·∫£i processing ƒë·ªÉ c√≥:\nC·∫•u tr√∫c ph·∫≥ng: D·ªÖ query v·ªõi SQL ƒê∆°n v·ªã th·ªëng nh·∫•t: Celsius, km/h, %\u0026hellip; D·ªØ li·ªáu s·∫°ch: Ch·ªâ gi·ªØ th√¥ng tin c·∫ßn thi·∫øt Rich insights: Heat index, comfort level, weather severity\u0026hellip; Lu·ªìng x·ª≠ l√Ω:\nRaw data t·ª´ Module 2 ƒë∆∞·ª£c l∆∞u v√†o S3 S3 Event trigger Lambda processor Lambda transform data v√† l∆∞u v√†o processed bucket Processed data s·∫µn s√†ng cho analytics (Module 4) B∆∞·ªõc 1: T·∫°o S3 Bucket cho Processed Data T·∫°i sao c·∫ßn chia bucket?\nT√°ch bi·ªát concerns: Raw vs Processed data Security: Kh√°c nhau v·ªÅ access permissions Cost optimization: Kh√°c nhau v·ªÅ storage class Analytics: Processed data t·ªëi ∆∞u cho query 1.1 T·∫°o Processed Data Bucket AWS Console ‚Üí S3 ‚Üí Create bucket\nBucket configuration:\nBucket name: weather-processed-{your-account-id} Region: ap-southeast-1 (same as raw bucket) Block all public access: Enabled Bucket versioning: Disable Default encryption: SSE-S3 Create bucket 1.2 T·∫°o Folder Structure T·∫°o folder structure t·ªëi ∆∞u cho analytics:\nweather-processed-{account-id}/\r‚îú‚îÄ‚îÄ current-weather/\r‚îú‚îÄ‚îÄ year=2025/\r‚îÇ ‚îú‚îÄ‚îÄ month=01/\r‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ day=03/\r‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ hour=00/\r‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ hcm_20250103_000000.json\r‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ hanoi_20250103_000000.json\r‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ ...\r‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ hour=01/\r‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ day=04/\r‚îÇ ‚îî‚îÄ‚îÄ month=02/\r‚îî‚îÄ‚îÄ year=2026/ ·ªû ƒë√¢y s·∫Ω d√πng Hive-style partitioning v√¨:\nAthena optimization: Query performance t·ªët h∆°n Cost savings: Ch·ªâ scan data c·∫ßn thi·∫øt Easy filtering: Filter theo year/month/day/hour Scalability: X·ª≠ l√Ω c√°c b·ªô d·ªØ li·ªáu l·ªõn m·ªôt c√°ch hi·ªáu qu·∫£ B∆∞·ªõc 2: T·∫°o Lambda Function cho Data Processing 2.1 T·∫°o Lambda Function AWS Console ‚Üí Lambda ‚Üí Create function\nFunction configuration:\nFunction name: weather-data-processor Runtime: Python 3.11 Architecture: x86_64 Execution role: WeatherCollectorLambdaRole Advanced settings: Memory: 512 MB Timeout: 5 minutes Environment variables: PROCESSED_BUCKET_NAME: weather-processed-{your-account-id} LOG_LEVEL: INFO 2.2 Lambda Function Code Thay th·∫ø code m·∫∑c ƒë·ªãnh b·∫±ng code sau:\nimport json import boto3 import datetime import logging from decimal import Decimal import os from urllib.parse import unquote_plus # Logging configuration logger = logging.getLogger() logger.setLevel(logging.INFO) # AWS clients with retry configuration s3_client = boto3.client(\u0026#39;s3\u0026#39;, config=boto3.session.Config( retries={\u0026#39;max_attempts\u0026#39;: 3, \u0026#39;mode\u0026#39;: \u0026#39;adaptive\u0026#39;} )) def lambda_handler(event, context): \u0026#34;\u0026#34;\u0026#34; Main Lambda handler for weather data processing \u0026#34;\u0026#34;\u0026#34; try: # Environment variable validation processed_bucket = os.environ.get(\u0026#39;PROCESSED_BUCKET_NAME\u0026#39;) if not processed_bucket: logger.error(\u0026#34;PROCESSED_BUCKET_NAME environment variable is required\u0026#34;) return { \u0026#39;statusCode\u0026#39;: 500, \u0026#39;body\u0026#39;: json.dumps({ \u0026#39;error\u0026#39;: \u0026#39;Configuration error\u0026#39;, \u0026#39;message\u0026#39;: \u0026#39;PROCESSED_BUCKET_NAME environment variable not set\u0026#39; }) } processed_count = 0 # Process each S3 event record for record in event[\u0026#39;Records\u0026#39;]: try: # Extract bucket and key from event source_bucket = record[\u0026#39;s3\u0026#39;][\u0026#39;bucket\u0026#39;][\u0026#39;name\u0026#39;] source_key_encoded = record[\u0026#39;s3\u0026#39;][\u0026#39;object\u0026#39;][\u0026#39;key\u0026#39;] source_key = unquote_plus(source_key_encoded) logger.info(f\u0026#34;Processing file: {source_key} from bucket: {source_bucket}\u0026#34;) if source_key_encoded != source_key: logger.debug(f\u0026#34;URL decoded key from {source_key_encoded} to {source_key}\u0026#34;) # Get raw weather data from S3 response = s3_client.get_object(Bucket=source_bucket, Key=source_key) raw_data = json.loads(response[\u0026#39;Body\u0026#39;].read().decode(\u0026#39;utf-8\u0026#39;)) # Transform weather data processed_data = transform_weather_data(raw_data) # Create key for processed file processed_key = source_key.replace(\u0026#39;raw/\u0026#39;, \u0026#39;processed/\u0026#39;).replace(\u0026#39;.json\u0026#39;, \u0026#39;.jsonl\u0026#39;) # Save processed data to S3 d∆∞·ªõi d·∫°ng NDJSON (jsonl) if isinstance(processed_data, list): jsonl_content = \u0026#39;\\n\u0026#39;.join(json.dumps(obj, default=decimal_default) for obj in processed_data) else: jsonl_content = json.dumps(processed_data, default=decimal_default) s3_client.put_object( Bucket=processed_bucket, Key=processed_key, Body=jsonl_content, ContentType=\u0026#39;application/jsonl; charset=utf-8\u0026#39;, ServerSideEncryption=\u0026#39;AES256\u0026#39; ) processed_count += 1 logger.info(f\u0026#34;Successfully processed and saved: {processed_key}\u0026#34;) except Exception as e: logger.error(f\u0026#34;Error processing record {source_key}: {str(e)}\u0026#34;) continue return { \u0026#39;statusCode\u0026#39;: 200, \u0026#39;body\u0026#39;: json.dumps({ \u0026#39;message\u0026#39;: f\u0026#39;Successfully processed {processed_count} files\u0026#39;, \u0026#39;processedCount\u0026#39;: processed_count }) } except Exception as e: logger.error(f\u0026#34;Lambda execution error: {str(e)}\u0026#34;) return { \u0026#39;statusCode\u0026#39;: 500, \u0026#39;body\u0026#39;: json.dumps({ \u0026#39;error\u0026#39;: str(e) }) } def transform_weather_data(raw_data): \u0026#34;\u0026#34;\u0026#34; Transform raw OpenWeatherMap data into analytics-friendly format \u0026#34;\u0026#34;\u0026#34; try: # Extract timestamp (use collection_timestamp if available, otherwise dt) if \u0026#39;collection_timestamp\u0026#39; in raw_data: timestamp = raw_data[\u0026#39;collection_timestamp\u0026#39;] collection_date = datetime.datetime.fromisoformat(timestamp.replace(\u0026#39;Z\u0026#39;, \u0026#39;+00:00\u0026#39;)).strftime(\u0026#39;%Y-%m-%d\u0026#39;) else: timestamp = datetime.datetime.fromtimestamp(raw_data[\u0026#39;dt\u0026#39;]).isoformat() + \u0026#39;Z\u0026#39; collection_date = datetime.datetime.fromtimestamp(raw_data[\u0026#39;dt\u0026#39;]).strftime(\u0026#39;%Y-%m-%d\u0026#39;) # Extract basic location and weather information processed_data = { \u0026#39;timestamp\u0026#39;: timestamp, \u0026#39;city_name\u0026#39;: raw_data.get(\u0026#39;name\u0026#39;, \u0026#39;Unknown\u0026#39;), \u0026#39;country\u0026#39;: raw_data.get(\u0026#39;sys\u0026#39;, {}).get(\u0026#39;country\u0026#39;, \u0026#39;Unknown\u0026#39;), \u0026#39;latitude\u0026#39;: raw_data.get(\u0026#39;coord\u0026#39;, {}).get(\u0026#39;lat\u0026#39;), \u0026#39;longitude\u0026#39;: raw_data.get(\u0026#39;coord\u0026#39;, {}).get(\u0026#39;lon\u0026#39;), \u0026#39;data_collection_date\u0026#39;: collection_date } # Add custom city metadata if available if \u0026#39;city_metadata\u0026#39; in raw_data: city_meta = raw_data[\u0026#39;city_metadata\u0026#39;] processed_data.update({ \u0026#39;city_name\u0026#39;: city_meta.get(\u0026#39;name\u0026#39;, processed_data[\u0026#39;city_name\u0026#39;]), \u0026#39;latitude\u0026#39;: city_meta.get(\u0026#39;lat\u0026#39;, processed_data[\u0026#39;latitude\u0026#39;]), \u0026#39;longitude\u0026#39;: city_meta.get(\u0026#39;lon\u0026#39;, processed_data[\u0026#39;longitude\u0026#39;]) }) # Temperature conversion (OpenWeatherMap returns Celsius when units=metric) temp_celsius = raw_data.get(\u0026#39;main\u0026#39;, {}).get(\u0026#39;temp\u0026#39;) if temp_celsius: processed_data[\u0026#39;temperature_celsius\u0026#39;] = round(temp_celsius, 2) processed_data[\u0026#39;temperature_fahrenheit\u0026#39;] = round(temp_celsius * 9/5 + 32, 2) processed_data[\u0026#39;temperature_kelvin\u0026#39;] = round(temp_celsius + 273.15, 2) # Feels like temperature feels_like_celsius = raw_data.get(\u0026#39;main\u0026#39;, {}).get(\u0026#39;feels_like\u0026#39;) if feels_like_celsius: processed_data[\u0026#39;feels_like_celsius\u0026#39;] = round(feels_like_celsius, 2) processed_data[\u0026#39;feels_like_fahrenheit\u0026#39;] = round(feels_like_celsius * 9/5 + 32, 2) # Other weather parameters processed_data.update({ \u0026#39;humidity_percent\u0026#39;: raw_data.get(\u0026#39;main\u0026#39;, {}).get(\u0026#39;humidity\u0026#39;), \u0026#39;pressure_hpa\u0026#39;: raw_data.get(\u0026#39;main\u0026#39;, {}).get(\u0026#39;pressure\u0026#39;), \u0026#39;visibility_meters\u0026#39;: raw_data.get(\u0026#39;visibility\u0026#39;), \u0026#39;uv_index\u0026#39;: raw_data.get(\u0026#39;uvi\u0026#39;) # If available }) # Weather description weather_list = raw_data.get(\u0026#39;weather\u0026#39;, []) if weather_list: weather = weather_list[0] processed_data.update({ \u0026#39;weather_id\u0026#39;: weather.get(\u0026#39;id\u0026#39;), \u0026#39;weather_main\u0026#39;: weather.get(\u0026#39;main\u0026#39;), \u0026#39;weather_description\u0026#39;: weather.get(\u0026#39;description\u0026#39;), \u0026#39;weather_icon\u0026#39;: weather.get(\u0026#39;icon\u0026#39;) }) # Wind information wind_data = raw_data.get(\u0026#39;wind\u0026#39;, {}) processed_data.update({ \u0026#39;wind_speed_ms\u0026#39;: wind_data.get(\u0026#39;speed\u0026#39;), \u0026#39;wind_direction_deg\u0026#39;: wind_data.get(\u0026#39;deg\u0026#39;), \u0026#39;wind_gust_ms\u0026#39;: wind_data.get(\u0026#39;gust\u0026#39;) }) # Convert wind speed to km/h and mph if wind_data.get(\u0026#39;speed\u0026#39;): processed_data[\u0026#39;wind_speed_kmh\u0026#39;] = round(wind_data[\u0026#39;speed\u0026#39;] * 3.6, 2) processed_data[\u0026#39;wind_speed_mph\u0026#39;] = round(wind_data[\u0026#39;speed\u0026#39;] * 2.237, 2) # Cloud coverage processed_data[\u0026#39;cloud_coverage_percent\u0026#39;] = raw_data.get(\u0026#39;clouds\u0026#39;, {}).get(\u0026#39;all\u0026#39;) # Precipitation (if available) rain_data = raw_data.get(\u0026#39;rain\u0026#39;, {}) if rain_data: processed_data[\u0026#39;rain_1h_mm\u0026#39;] = rain_data.get(\u0026#39;1h\u0026#39;) processed_data[\u0026#39;rain_3h_mm\u0026#39;] = rain_data.get(\u0026#39;3h\u0026#39;) snow_data = raw_data.get(\u0026#39;snow\u0026#39;, {}) if snow_data: processed_data[\u0026#39;snow_1h_mm\u0026#39;] = snow_data.get(\u0026#39;1h\u0026#39;) processed_data[\u0026#39;snow_3h_mm\u0026#39;] = snow_data.get(\u0026#39;3h\u0026#39;) # Add derived fields processed_data.update(calculate_derived_fields(processed_data)) return processed_data except Exception as e: logger.error(f\u0026#34;Weather data transformation error: {str(e)}\u0026#34;) raise def calculate_derived_fields(data): \u0026#34;\u0026#34;\u0026#34; Calculate derived weather indicators \u0026#34;\u0026#34;\u0026#34; derived = {} try: # Calculate heat index (simplified) temp_f = data.get(\u0026#39;temperature_fahrenheit\u0026#39;) humidity = data.get(\u0026#39;humidity_percent\u0026#39;) if temp_f and humidity: if temp_f \u0026gt;= 80: # Heat index only meaningful above 80¬∞F # Simplified heat index formula heat_index_f = ( -42.379 + 2.04901523 * temp_f + 10.14333127 * humidity - 0.22475541 * temp_f * humidity - 6.83783e-3 * temp_f**2 - 5.481717e-2 * humidity**2 + 1.22874e-3 * temp_f**2 * humidity + 8.5282e-4 * temp_f * humidity**2 - 1.99e-6 * temp_f**2 * humidity**2 ) derived[\u0026#39;heat_index_fahrenheit\u0026#39;] = round(heat_index_f, 2) derived[\u0026#39;heat_index_celsius\u0026#39;] = round((heat_index_f - 32) * 5/9, 2) # Comfort level based on temperature and humidity temp_c = data.get(\u0026#39;temperature_celsius\u0026#39;) if temp_c and humidity: if temp_c \u0026lt; 10: comfort = \u0026#39;cold\u0026#39; elif temp_c \u0026lt; 18: comfort = \u0026#39;cool\u0026#39; elif temp_c \u0026lt;= 24 and humidity \u0026lt;= 60: comfort = \u0026#39;comfortable\u0026#39; elif temp_c \u0026lt;= 30 and humidity \u0026lt;= 70: comfort = \u0026#39;warm\u0026#39; else: comfort = \u0026#39;hot\u0026#39; derived[\u0026#39;comfort_level\u0026#39;] = comfort # Wind condition wind_speed_kmh = data.get(\u0026#39;wind_speed_kmh\u0026#39;) if wind_speed_kmh: if wind_speed_kmh \u0026lt; 5: wind_condition = \u0026#39;calm\u0026#39; elif wind_speed_kmh \u0026lt; 20: wind_condition = \u0026#39;light\u0026#39; elif wind_speed_kmh \u0026lt; 40: wind_condition = \u0026#39;moderate\u0026#39; elif wind_speed_kmh \u0026lt; 60: wind_condition = \u0026#39;strong\u0026#39; else: wind_condition = \u0026#39;very_strong\u0026#39; derived[\u0026#39;wind_condition\u0026#39;] = wind_condition # Weather severity level weather_main = data.get(\u0026#39;weather_main\u0026#39;, \u0026#39;\u0026#39;).lower() if weather_main: if weather_main in [\u0026#39;thunderstorm\u0026#39;, \u0026#39;tornado\u0026#39;]: severity = \u0026#39;severe\u0026#39; elif weather_main in [\u0026#39;rain\u0026#39;, \u0026#39;snow\u0026#39;, \u0026#39;drizzle\u0026#39;]: severity = \u0026#39;moderate\u0026#39; elif weather_main in [\u0026#39;mist\u0026#39;, \u0026#39;fog\u0026#39;, \u0026#39;haze\u0026#39;]: severity = \u0026#39;light\u0026#39; else: severity = \u0026#39;normal\u0026#39; derived[\u0026#39;weather_severity\u0026#39;] = severity return derived except Exception as e: logger.error(f\u0026#34;Error calculating derived fields: {str(e)}\u0026#34;) return {} def decimal_default(obj): \u0026#34;\u0026#34;\u0026#34; JSON serializer for objects that are not serializable by default \u0026#34;\u0026#34;\u0026#34; if isinstance(obj, Decimal): return float(obj) raise TypeError Deploy code b·∫±ng c√°ch click \u0026ldquo;Deploy\u0026rdquo; B∆∞·ªõc 3: Thi·∫øt l·∫≠p S3 Event Trigger Quan tr·ªçng: S3 Event Trigger s·∫Ω t·ª± ƒë·ªông ch·∫°y Lambda m·ªói khi c√≥ file m·ªõi ƒë∆∞·ª£c upload v√†o raw bucket. ƒê·∫£m b·∫£o Lambda function ho·∫°t ƒë·ªông ƒë√∫ng tr∆∞·ªõc khi enable trigger.\n3.1 Th√™m Permission cho S3 invoke Lambda Lambda Console ‚Üí weather-data-processor ‚Üí Configuration ‚Üí Permissions\nResource-based policy ‚Üí Add permissions:\nPrincipal: s3.amazonaws.com Source ARN: arn:aws:s3:::weather-data-{your-account-id} Action: lambda:InvokeFunction 3.2 Configure S3 Event Notification S3 Console ‚Üí weather-data-{your-account-id} bucket ‚Üí Properties\nEvent notifications ‚Üí Create event notification:\nEvent name: weather-data-processing-trigger Event types: All object create events Prefix: raw/ Suffix: .json Destination: Lambda function ‚Üí weather-data-processor Save changes B∆∞·ªõc 4: Testing Data Processing Test v·ªõi Real Data t·ª´ Module 2 N·∫øu EventBridge rules t·ª´ Module 2 ƒëang ch·∫°y:\nCh·ªù Lambda t·ª± ƒë·ªông ch·∫°y: EventBridge s·∫Ω trigger functions theo l·ªãch:\nCurrent weather: M·ªói gi·ªù Monitoring real-time processing:\n# Check raw data ƒë∆∞·ª£c t·∫°o aws s3 ls s3://weather-data-{your-account-id}/raw/current-weather/ --recursive # Check processed data ƒë∆∞·ª£c t·∫°o aws s3 ls s3://weather-processed-{your-account-id}/current-weather/ --recursive CloudWatch Logs real-time:\nLambda Console ‚Üí Functions ‚Üí weather-data-processor ‚Üí Monitor ‚Üí View logs in CloudWatch Expected workflow:\nModule 2 EventBridge ‚Üí weather-current-collector ‚Üí S3 raw/current-weather/\r‚Üì (S3 Event)\rweather-data-processor ‚Üí S3 processed/current-weather/ T·ªïng k·∫øt ƒê√£ ho√†n th√†nh:\nS3 Processed Bucket: Storage t·ªëi ∆∞u cho analytics Lambda Data Processor: Transform current weather data S3 Event Triggers: T·ª± ƒë·ªông processing khi c√≥ raw data Data Transformation: Clean, enrich, standardize weather data Hive Partitioning: Analytics-ready folder structure Error Handling: Robust error handling v√† retry logic K·∫øt qu·∫£:\nWeather data ƒë∆∞·ª£c transform t·ª´ complex JSON ‚Üí flat structure Temperature converted t·ª´ Kelvin ‚Üí Celsius/Fahrenheit Derived metrics: comfort level, wind condition, weather severity Partitioned data cho efficient querying Real-time processing pipeline ho·∫°t ƒë·ªông 24/7 S·∫µn s√†ng cho Module 4: Data Analytics v√† Visualization!\n"
},
{
	"uri": "//localhost:1313/vi/4-data-storage-solutions/",
	"title": "Ph√¢n t√≠ch D·ªØ li·ªáu v·ªõi Athena",
	"tags": [],
	"description": "",
	"content": "Ph√¢n t√≠ch D·ªØ li·ªáu v·ªõi Athena Trong module n√†y, ta s·∫Ω s·ª≠ d·ª•ng Amazon Athena ƒë·ªÉ ch·∫°y c√°c truy v·∫•n SQL tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu th·ªùi ti·∫øt ƒë√£ x·ª≠ l√Ω ƒë∆∞·ª£c l∆∞u tr·ªØ trong S3. Athena l√† d·ªãch v·ª• truy v·∫•n serverless gi√∫p d·ªÖ d√†ng ph√¢n t√≠ch d·ªØ li·ªáu b·∫±ng SQL ti√™u chu·∫©n m√† kh√¥ng c·∫ßn thi·∫øt l·∫≠p c∆° s·ªü h·∫° t·∫ßng kho d·ªØ li·ªáu ph·ª©c t·∫°p.\nM·ª•c ti√™u Module Thi·∫øt l·∫≠p Amazon Athena ƒë·ªÉ query d·ªØ li·ªáu t·ª´ S3 T·∫°o database v√† external table cho d·ªØ li·ªáu th·ªùi ti·∫øt Vi·∫øt SQL queries ƒë·ªÉ ph√¢n t√≠ch d·ªØ li·ªáu th·ªùi ti·∫øt S·ª≠ d·ª•ng c√°c tr∆∞·ªùng ƒë√£ enriched nh∆∞ comfort_level, weather_severity, wind_condition T·∫°o reports v√† insights t·ª´ d·ªØ li·ªáu th·ªùi ti·∫øt T·ªëi ∆∞u h√≥a performance v√† cost cho Athena queries ƒêi·ªÅu ki·ªán ti√™n quy·∫øt Ho√†n th√†nh Module 3: X·ª≠ l√Ω v√† Chuy·ªÉn ƒë·ªïi D·ªØ li·ªáu C√≥ d·ªØ li·ªáu th·ªùi ti·∫øt ƒë√£ x·ª≠ l√Ω trong S3 v·ªõi format JSON ƒë√£ cung c·∫•p Truy c·∫≠p AWS Console v·ªõi quy·ªÅn Administrator ho·∫∑c quy·ªÅn cho Athena, S3 Hi·ªÉu bi·∫øt c∆° b·∫£n v·ªÅ SQL (SELECT, WHERE, GROUP BY, etc.) Ki·ªÉm tra d·ªØ li·ªáu: H√£y ch·∫Øc ch·∫Øn r·∫±ng b·∫°n c√≥ d·ªØ li·ªáu JSON trong S3 bucket processed v·ªõi c·∫•u tr√∫c\nB∆∞·ªõc 1: Thi·∫øt l·∫≠p S3 Bucket cho Athena Query Results Athena c·∫ßn m·ªôt S3 bucket ƒë·ªÉ l∆∞u tr·ªØ k·∫øt qu·∫£ truy v·∫•n. Ch√∫ng ta s·∫Ω t·∫°o bucket n√†y th·ªß c√¥ng qua AWS Console.\n1.1 T·∫°o S3 Bucket cho Query Results B∆∞·ªõc 1: Truy c·∫≠p S3 Console\nƒêƒÉng nh·∫≠p v√†o AWS Console T√¨m ki·∫øm v√† ch·ªçn S3 service Nh·∫•p Create bucket B∆∞·ªõc 2: C·∫•u h√¨nh Bucket\nBucket name: Nh·∫≠p t√™n unique, v√≠ d·ª•: weather-athena-query-results-[your-account-id]\nRegion: Ch·ªçn c√πng region v·ªõi bucket d·ªØ li·ªáu weather c·ªßa b·∫°n\nObject Ownership: ƒê·ªÉ m·∫∑c ƒë·ªãnh ACLs disabled\nBlock Public Access: ƒê·ªÉ m·∫∑c ƒë·ªãnh (block all public access)\nB∆∞·ªõc 3: Advanced Settings\nBucket Versioning: Disable (kh√¥ng c·∫ßn thi·∫øt cho query results) Default encryption: Enable v·ªõi Amazon S3 managed keys (SSE-S3) Nh·∫•p Create bucket 1.2 Thi·∫øt l·∫≠p Lifecycle Policy (T√πy ch·ªçn) ƒê·ªÉ t·ª± ƒë·ªông x√≥a query results c≈© v√† ti·∫øt ki·ªám chi ph√≠:\nB∆∞·ªõc 1: V√†o Bucket Management\nNh·∫•p v√†o bucket v·ª´a t·∫°o Ch·ªçn tab Management Nh·∫•p Create lifecycle rule B∆∞·ªõc 2: C·∫•u h√¨nh Lifecycle Rule\nRule name: delete-old-query-results Status: Enable Rule scope: Apply to all objects in the bucket Lifecycle rule actions: Expire current versions of objects Expire current versions of objects: 30 days Nh·∫•p Create rule Lifecycle policy n√†y s·∫Ω t·ª± ƒë·ªông x√≥a query results sau 30 ng√†y ƒë·ªÉ ti·∫øt ki·ªám chi ph√≠ storage.\n1.3 C·∫•u h√¨nh Athena Query Result Location B∆∞·ªõc 1: Truy c·∫≠p Athena Console\nT√¨m ki·∫øm v√† ch·ªçn Amazon Athena service B∆∞·ªõc 2: Set up Query Result Location\nCh·ªçn Query editor ·ªü menu b√™n ph·∫£i Nh·∫•p Settings ·ªü g√≥c ph·∫£i tr√™n c√πng Nh·∫•p Manage B∆∞·ªõc 3: Configure Location\nQuery result location: Ch·ªçn Browse S3 ƒëang c√≥ s·∫µn l√† bucket result v·ª´a t·∫°o ·ªü tr√™n\nNh·ªõ th√™m / ·ªü cu·ªëi ƒë∆∞·ªùng d·∫´n S3!\nExpected bucket owner: ƒê·ªÉ tr·ªëng\nEncrypt query results: Check v√† ch·ªçn SSE-S3\nNh·∫•p Save\nB∆∞·ªõc 2: T·∫°o Database v√† External Table 2.1 T·∫°o Weather Analytics Database B∆∞·ªõc 1: M·ªü Query Editor\nTrong Athena Console, ch·ªçn Query editor t·ª´ menu b√™n tr√°i ƒê·∫£m b·∫£o b·∫°n ƒëang ·ªü Data source: AwsDataCatalog Database: default B∆∞·ªõc 2: T·∫°o Database\nCopy v√† ch·∫°y query sau trong Athena Query Editor:\nCREATE DATABASE IF NOT EXISTS weather_analytics LOCATION \u0026#39;s3://weather-athena-query-results-[your-account-id]/databases/weather_analytics/\u0026#39;; B∆∞·ªõc 3: Ch·ªçn Database\nSau khi query ch·∫°y th√†nh c√¥ng, refresh page Trong dropdown Database, ch·ªçn weather_analytics 2.2 T·∫°o External Table cho Weather Data B∆∞·ªõc 1: Chu·∫©n b·ªã Schema\nD·ª±a tr√™n c·∫•u tr√∫c JSON ƒë√£ x·ª≠ l√Ω tr∆∞·ªõc ƒë√≥, ch√∫ng ta s·∫Ω t·∫°o external table:\nCREATE EXTERNAL TABLE IF NOT EXISTS weather_analytics.current_weather ( timestamp STRING, city_name STRING, country STRING, latitude DOUBLE, longitude DOUBLE, data_collection_date STRING, temperature_celsius DOUBLE, temperature_fahrenheit DOUBLE, temperature_kelvin DOUBLE, feels_like_celsius DOUBLE, feels_like_fahrenheit DOUBLE, humidity_percent INT, pressure_hpa INT, visibility_meters BIGINT, uv_index DOUBLE, weather_id INT, weather_main STRING, weather_description STRING, weather_icon STRING, wind_speed_ms DOUBLE, wind_direction_deg INT, wind_gust_ms DOUBLE, wind_speed_kmh DOUBLE, wind_speed_mph DOUBLE, cloud_coverage_percent INT, heat_index_fahrenheit DOUBLE, heat_index_celsius DOUBLE, comfort_level STRING, wind_condition STRING, weather_severity STRING ) ROW FORMAT SERDE \u0026#39;org.openx.data.jsonserde.JsonSerDe\u0026#39; WITH SERDEPROPERTIES ( \u0026#39;serialization.format\u0026#39; = \u0026#39;1\u0026#39; ) LOCATION \u0026#39;s3://your-weather-processed-bucket/processed/\u0026#39; TBLPROPERTIES ( \u0026#39;has_encrypted_data\u0026#39;=\u0026#39;false\u0026#39;, \u0026#39;projection.enabled\u0026#39;=\u0026#39;true\u0026#39;, \u0026#39;projection.data_collection_date.type\u0026#39;=\u0026#39;date\u0026#39;, \u0026#39;projection.data_collection_date.range\u0026#39;=\u0026#39;2025-01-01,NOW\u0026#39;, \u0026#39;projection.data_collection_date.format\u0026#39;=\u0026#39;yyyy-MM-dd\u0026#39;, \u0026#39;storage.location.template\u0026#39;=\u0026#39;s3://your-weather-processed-bucket/processed/year=${data_collection_date}\u0026#39; ); Schema Explanation:\nSchema n√†y match ch√≠nh x√°c v·ªõi JSON structure t·ª´ module 3 Bao g·ªìm c√°c tr∆∞·ªùng m·ªõi: comfort_level, wind_condition, weather_severity S·ª≠ d·ª•ng JsonSerDe ƒë·ªÉ parse JSON files C√≥ partition projection cho performance t·ªët h∆°n 2.3 Verify Table Creation Test Basic Query\nSELECT COUNT(*) as total_records FROM weather_analytics.current_weather; Sample Data\nSELECT * FROM weather_analytics.current_weather ORDER BY timestamp DESC LIMIT 5; B∆∞·ªõc 3: Ph√¢n t√≠ch D·ªØ li·ªáu C∆° b·∫£n 3.1 Data Quality Check Ki·ªÉm tra ch·∫•t l∆∞·ª£ng d·ªØ li·ªáu:\nSELECT COUNT(*) as total_records, COUNT(DISTINCT city_name) as unique_cities, COUNT(DISTINCT data_collection_date) as unique_dates, COUNT(temperature_celsius) as temp_records, COUNT(comfort_level) as comfort_records, COUNT(weather_severity) as severity_records, MIN(data_collection_date) as earliest_date, MAX(data_collection_date) as latest_date FROM weather_analytics.current_weather; 3.2 City-wise Temperature Analysis Ph√¢n t√≠ch nhi·ªát ƒë·ªô theo th√†nh ph·ªë:\nWITH base_data AS ( SELECT CASE WHEN city_name IN (\u0026#39;HoChiMinh\u0026#39;, \u0026#39;Ho Chi Minh City\u0026#39;, \u0026#39;TPHCM\u0026#39;) THEN \u0026#39;Ho Chi Minh\u0026#39; WHEN city_name IN (\u0026#39;CanTho\u0026#39;, \u0026#39;Can Tho\u0026#39;) THEN \u0026#39;Can Tho\u0026#39; WHEN city_name IN (\u0026#39;GiaLai\u0026#39;, \u0026#39;Pleiku\u0026#39;) THEN \u0026#39;Gia Lai\u0026#39; WHEN city_name IN (\u0026#39;Da Nang\u0026#39;, \u0026#39;Danang\u0026#39;, \u0026#39;Ap Ba\u0026#39;) THEN \u0026#39;Da Nang\u0026#39; WHEN city_name IN (\u0026#39;Hanoi\u0026#39;, \u0026#39;Ha Noi\u0026#39;, \u0026#39;Xom Pho\u0026#39;) THEN \u0026#39;Ha Noi\u0026#39; WHEN city_name IN (\u0026#39;Hue\u0026#39;) THEN \u0026#39;Hue\u0026#39; ELSE city_name END AS standardized_city, country, comfort_level, temperature_celsius, heat_index_celsius FROM weather_analytics.current_weather ), comfort_counts AS ( SELECT standardized_city, country, comfort_level, COUNT(*) AS level_count, ROW_NUMBER() OVER ( PARTITION BY standardized_city, country ORDER BY COUNT(*) DESC ) AS rn FROM base_data GROUP BY standardized_city, country, comfort_level ) SELECT t.standardized_city AS city_name, t.country, COUNT(*) AS measurement_count, ROUND(AVG(t.temperature_celsius), 2) AS avg_temp_celsius, ROUND(MIN(t.temperature_celsius), 2) AS min_temp_celsius, ROUND(MAX(t.temperature_celsius), 2) AS max_temp_celsius, ROUND(AVG(t.heat_index_celsius), 2) AS avg_heat_index, c.comfort_level AS most_common_comfort_level FROM base_data t LEFT JOIN comfort_counts c ON t.standardized_city = c.standardized_city AND t.country = c.country AND c.rn = 1 GROUP BY t.standardized_city, t.country, c.comfort_level ORDER BY avg_temp_celsius DESC; 3.3 Comfort Level Distribution Ph√¢n t√≠ch comfort level:\nSELECT comfort_level, COUNT(*) as occurrence_count, ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (), 2) as percentage, ROUND(AVG(temperature_celsius), 2) as avg_temp, ROUND(AVG(humidity_percent), 2) as avg_humidity, ROUND(AVG(heat_index_celsius), 2) as avg_heat_index FROM weather_analytics.current_weather WHERE comfort_level IS NOT NULL GROUP BY comfort_level ORDER BY occurrence_count DESC; 3.4 Weather Severity Analysis Ph√¢n t√≠ch m·ª©c ƒë·ªô nghi√™m tr·ªçng th·ªùi ti·∫øt:\nSELECT weather_severity, COUNT(*) as total_occurrences, COUNT(DISTINCT city_name) as cities_affected, ROUND(AVG(temperature_celsius), 2) as avg_temperature, ROUND(AVG(wind_speed_kmh), 2) as avg_wind_speed, ROUND(AVG(humidity_percent), 2) as avg_humidity, ROUND(AVG(pressure_hpa), 2) as avg_pressure FROM weather_analytics.current_weather WHERE weather_severity IS NOT NULL GROUP BY weather_severity ORDER BY CASE weather_severity WHEN \u0026#39;severe\u0026#39; THEN 1 WHEN \u0026#39;moderate\u0026#39; THEN 2 WHEN \u0026#39;light\u0026#39; THEN 3 ELSE 4 END; B∆∞·ªõc 4: Advanced Analytics 4.1 Daily Weather Summary T·∫°o b√°o c√°o th·ªùi ti·∫øt h√†ng ng√†y:\nWITH mode_counts AS ( SELECT data_collection_date, city_name, weather_main, comfort_level, wind_condition, weather_severity, COUNT(*) AS freq, ROW_NUMBER() OVER (PARTITION BY data_collection_date, city_name ORDER BY COUNT(*) DESC) AS rn_weather, ROW_NUMBER() OVER (PARTITION BY data_collection_date, city_name, comfort_level ORDER BY COUNT(*) DESC) AS rn_comfort, ROW_NUMBER() OVER (PARTITION BY data_collection_date, city_name, wind_condition ORDER BY COUNT(*) DESC) AS rn_wind, ROW_NUMBER() OVER (PARTITION BY data_collection_date, city_name, weather_severity ORDER BY COUNT(*) DESC) AS rn_severity FROM weather_analytics.current_weather WHERE DATE(data_collection_date) \u0026gt;= DATE(\u0026#39;2025-07-01\u0026#39;) GROUP BY data_collection_date, city_name, weather_main, comfort_level, wind_condition, weather_severity ) SELECT stats.data_collection_date, stats.city_name, stats.daily_measurements, stats.avg_temp_c, stats.avg_humidity, stats.avg_pressure, stats.avg_wind_kmh, m.weather_main AS dominant_weather, m.comfort_level AS dominant_comfort, m.wind_condition AS dominant_wind_condition, m.weather_severity AS dominant_severity FROM ( SELECT data_collection_date, city_name, COUNT(*) AS daily_measurements, ROUND(AVG(temperature_celsius), 1) AS avg_temp_c, ROUND(AVG(humidity_percent), 1) AS avg_humidity, ROUND(AVG(pressure_hpa), 1) AS avg_pressure, ROUND(AVG(wind_speed_kmh), 1) AS avg_wind_kmh FROM weather_analytics.current_weather WHERE DATE(data_collection_date) \u0026gt;= DATE(\u0026#39;2025-07-01\u0026#39;) GROUP BY data_collection_date, city_name ) stats LEFT JOIN mode_counts m ON stats.data_collection_date = m.data_collection_date AND stats.city_name = m.city_name AND m.rn_weather = 1 AND m.rn_comfort = 1 AND m.rn_wind = 1 AND m.rn_severity = 1 ORDER BY stats.data_collection_date DESC, stats.city_name; 4.2 Weather Pattern Correlation Ph√¢n t√≠ch m·ªëi t∆∞∆°ng quan gi·ªØa c√°c y·∫øu t·ªë th·ªùi ti·∫øt:\nSELECT comfort_level, weather_main, weather_severity, COUNT(*) as occurrence_count, ROUND(AVG(temperature_celsius), 2) as avg_temperature, ROUND(AVG(humidity_percent), 2) as avg_humidity, ROUND(AVG(heat_index_celsius), 2) as avg_heat_index, ROUND(AVG(wind_speed_kmh), 2) as avg_wind_speed FROM weather_analytics.current_weather WHERE comfort_level IS NOT NULL AND weather_severity IS NOT NULL GROUP BY comfort_level, weather_main, weather_severity HAVING COUNT(*) \u0026gt;= 3 -- Ch·ªâ hi·ªÉn th·ªã patterns v·ªõi √≠t nh·∫•t 3 occurrences ORDER BY comfort_level, occurrence_count DESC; 4.3 Wind Analysis Ph√¢n t√≠ch ƒëi·ªÅu ki·ªán gi√≥:\nSELECT city_name, wind_condition, COUNT(*) as occurrence_count, ROUND(AVG(wind_speed_kmh), 2) as avg_wind_speed_kmh, ROUND(MAX(wind_speed_kmh), 2) as max_wind_speed_kmh, ROUND(AVG(wind_gust_ms), 2) as avg_wind_gust_ms, CASE WHEN AVG(wind_direction_deg) BETWEEN 0 AND 45 OR AVG(wind_direction_deg) BETWEEN 315 AND 360 THEN \u0026#39;North\u0026#39; WHEN AVG(wind_direction_deg) BETWEEN 45 AND 135 THEN \u0026#39;East\u0026#39; WHEN AVG(wind_direction_deg) BETWEEN 135 AND 225 THEN \u0026#39;South\u0026#39; WHEN AVG(wind_direction_deg) BETWEEN 225 AND 315 THEN \u0026#39;West\u0026#39; ELSE \u0026#39;Variable\u0026#39; END as dominant_wind_direction FROM weather_analytics.current_weather WHERE wind_condition IS NOT NULL GROUP BY city_name, wind_condition ORDER BY city_name, avg_wind_speed_kmh DESC; B∆∞·ªõc 5: T·∫°o Views cho Reporting 5.1 Daily Weather Summary View T·∫°o view cho b√°o c√°o h√†ng ng√†y:\nCREATE OR REPLACE VIEW weather_analytics.daily_weather_summary AS SELECT data_collection_date, city_name, country, COUNT(*) as measurement_count, ROUND(AVG(temperature_celsius), 2) as avg_temperature, ROUND(AVG(feels_like_celsius), 2) as avg_feels_like, ROUND(AVG(heat_index_celsius), 2) as avg_heat_index, ROUND(AVG(humidity_percent), 2) as avg_humidity, ROUND(AVG(pressure_hpa), 2) as avg_pressure, ROUND(AVG(wind_speed_kmh), 2) as avg_wind_speed, MODE() WITHIN GROUP (ORDER BY weather_main) as dominant_weather, MODE() WITHIN GROUP (ORDER BY comfort_level) as dominant_comfort_level, MODE() WITHIN GROUP (ORDER BY wind_condition) as dominant_wind_condition, MODE() WITHIN GROUP (ORDER BY weather_severity) as dominant_weather_severity FROM weather_analytics.current_weather GROUP BY data_collection_date, city_name, country; 5.2 S·ª≠ d·ª•ng Views Query t·ª´ view:\nSELECT * FROM weather_analytics.daily_weather_summary WHERE data_collection_date \u0026gt;= DATE(\u0026#39;2025-07-01\u0026#39;) ORDER BY data_collection_date DESC, city_name; Export results:\nCh·∫°y query trong Athena Nh·∫•p Download ƒë·ªÉ l∆∞u k·∫øt qu·∫£ CSV K·∫øt qu·∫£ c≈©ng t·ª± ƒë·ªông l∆∞u trong S3 query results bucket B∆∞·ªõc 6: Performance Optimization 6.1 Query Optimization Tips 1. Use LIMIT for exploration:\nSELECT * FROM weather_analytics.current_weather WHERE data_collection_date = \u0026#39;2025-07-14\u0026#39; LIMIT 100; 2. Filter on partitioned columns:\n-- Efficient - filter on date partition SELECT * FROM weather_analytics.current_weather WHERE data_collection_date BETWEEN \u0026#39;2025-07-01\u0026#39; AND \u0026#39;2025-07-14\u0026#39;; 3. Select only needed columns:\n-- Better performance SELECT city_name, temperature_celsius, comfort_level, weather_severity FROM weather_analytics.current_weather; 6.2 Cost Optimization Monitor usage:\nCheck CloudWatch metrics for data scanned Use Athena Query History ƒë·ªÉ track costs Consider Parquet format cho datasets l·ªõn Cost Saving Tips:\nS·ª≠ d·ª•ng WHERE clauses ƒë·ªÉ gi·∫£m data scanned Compress data files Use columnar formats nh∆∞ Parquet cho better performance Set up CloudWatch alarms cho spending thresholds üîß Troubleshooting V·∫•n ƒë·ªÅ 1: \u0026ldquo;Table not found\u0026rdquo; Nguy√™n nh√¢n v√† gi·∫£i ph√°p:\n‚úÖ Ki·ªÉm tra S3 bucket permissions ‚úÖ Verify data t·ªìn t·∫°i trong S3 location ‚úÖ ƒê·∫£m b·∫£o schema match v·ªõi JSON data structure V·∫•n ƒë·ªÅ 2: \u0026ldquo;Zero records returned\u0026rdquo; Nguy√™n nh√¢n v√† gi·∫£i ph√°p:\n‚úÖ Verify JSON format ƒë√∫ng chu·∫©n ‚úÖ Check S3 path trong table definition ‚úÖ Ensure files c√≥ ƒë√∫ng extension (.json) V·∫•n ƒë·ªÅ 3: \u0026ldquo;SerDe errors\u0026rdquo; Nguy√™n nh√¢n v√† gi·∫£i ph√°p:\n‚úÖ JSON ph·∫£i valid (kh√¥ng c√≥ trailing commas) ‚úÖ Data types match v·ªõi schema definition ‚úÖ Consistent field names trong JSON V·∫•n ƒë·ªÅ 4: \u0026ldquo;Permission denied\u0026rdquo; Nguy√™n nh√¢n v√† gi·∫£i ph√°p:\n‚úÖ Check IAM permissions cho Athena v√† S3 ‚úÖ Verify bucket policies ‚úÖ Ensure query results bucket c√≥ write permission üí∞ Cost Analysis Estimated costs cho module n√†y:\nService Usage Cost Athena Queries ~$5 per TB scanned $0.10-0.50 S3 Storage Query results ~10MB $0.01 S3 Requests 100-200 requests $0.01 Total ~$0.12-0.52 V·ªõi typical weather dataset (1-10 MB), chi ph√≠ s·∫Ω r·∫•t th·∫•p trong AWS Free Tier.\nüéØ Next Steps Sau khi ho√†n th√†nh module n√†y, b·∫°n ƒë√£ c√≥ th·ªÉ:\n‚úÖ Analyze weather data v·ªõi SQL queries ph·ª©c t·∫°p\n‚úÖ Create insights t·ª´ comfort levels v√† weather severity\n‚úÖ Generate reports cho business applications\n‚úÖ Understand weather patterns qua correlations\nChu·∫©n b·ªã cho Module 5:\nTrong module ti·∫øp theo, ch√∫ng ta s·∫Ω t·∫°o QuickSight dashboards t·ª´ Athena data Visualize weather trends v√† patterns Create interactive business intelligence reports Practice Suggestions:\nTh·ª≠ c√°c SQL queries kh√°c nhau ƒë·ªÉ explore data T·∫°o more complex views cho specific business needs Experiment v·ªõi different time ranges v√† filters Business Value: C√°c analysis n√†y c√≥ th·ªÉ apply cho tourism (weather-based recommendations), agriculture (irrigation planning), logistics (weather-aware routing), v√† energy management (demand forecasting).\nImportant Reminders:\nLu√¥n thay bucket names b·∫±ng t√™n th·ª±c t·∫ø Monitor costs qua CloudWatch Backup important queries d∆∞·ªõi d·∫°ng saved queries "
},
{
	"uri": "//localhost:1313/vi/5-analytics-visualization/",
	"title": "Tr·ª±c quan h√≥a D·ªØ li·ªáu v·ªõi QuickSight",
	"tags": [],
	"description": "",
	"content": "Tr·ª±c quan h√≥a D·ªØ li·ªáu v·ªõi Amazon QuickSight B√¢y gi·ªù khi b·∫°n ƒë√£ c√≥ d·ªØ li·ªáu th·ªùi ti·∫øt ƒë∆∞·ª£c l∆∞u tr·ªØ v√† c√≥ th·ªÉ truy v·∫•n th√¥ng qua Athena, ƒë√£ ƒë·∫øn l√∫c t·∫°o c√°c tr·ª±c quan h√≥a h·∫•p d·∫´n! Trong module n√†y, b·∫°n s·∫Ω s·ª≠ d·ª•ng Amazon QuickSight ƒë·ªÉ x√¢y d·ª±ng dashboard t∆∞∆°ng t√°c gi√∫p d·ªØ li·ªáu th·ªùi ti·∫øt c·ªßa b·∫°n tr·ªü n√™n sinh ƒë·ªông.\nT·ªïng quan Module Amazon QuickSight l√† d·ªãch v·ª• business intelligence (BI) c·ªßa AWS gi√∫p d·ªÖ d√†ng t·∫°o v√† xu·∫•t b·∫£n c√°c dashboard t∆∞∆°ng t√°c. B·∫°n s·∫Ω k·∫øt n·ªëi QuickSight v·ªõi ngu·ªìn d·ªØ li·ªáu Athena v√† t·∫°o c√°c tr·ª±c quan h√≥a ti·∫øt l·ªô c√°c m·∫´u v√† th√¥ng tin chi ti·∫øt t·ª´ d·ªØ li·ªáu th·ªùi ti·∫øt.\nTh·ªùi gian: 45-60 ph√∫t\nChi ph√≠: ~$3-4 (s·ª≠ d·ª•ng d√πng th·ª≠ mi·ªÖn ph√≠)\nNh·ªØng g√¨ b·∫°n s·∫Ω X√¢y d·ª±ng graph LR\rA[Athena Data] --\u0026gt; B[QuickSight Dataset]\rB --\u0026gt; C[Visualizations]\rC --\u0026gt; D[Interactive Dashboard]\rD --\u0026gt; E[Published Reports]\rstyle B fill:#ff9900,stroke:#232f3e,stroke-width:3px\rstyle D fill:#66bb6a ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒê√£ ho√†n th√†nh Module 4: Ph√¢n t√≠ch D·ªØ li·ªáu v·ªõi Athena D·ªØ li·ªáu th·ªùi ti·∫øt c√≥ s·∫µn trong b·∫£ng Athena T√†i kho·∫£n AWS v·ªõi quy·ªÅn QuickSight B∆∞·ªõc 1: Thi·∫øt l·∫≠p Amazon QuickSight 1.1 ƒêƒÉng k√Ω QuickSight ƒêi·ªÅu h∆∞·ªõng ƒë·∫øn Amazon QuickSight console Nh·∫•p Sign up for QuickSight Ch·ªçn Standard Edition (bao g·ªìm d√πng th·ª≠ mi·ªÖn ph√≠ 30 ng√†y) Nh·∫≠p th√¥ng tin t√†i kho·∫£n: Account name: weather-analytics-[ten-ban] Notification email: ƒê·ªãa ch·ªâ email c·ªßa b·∫°n Nh·∫•p Finish 1.2 C·∫•u h√¨nh Quy·ªÅn QuickSight Trong QuickSight, nh·∫•p bi·ªÉu t∆∞·ª£ng profile (g√≥c ph·∫£i tr√™n) Ch·ªçn Manage QuickSight Ch·ªçn Security \u0026amp; permissions Nh·∫•p Add or remove K√≠ch ho·∫°t c√°c d·ªãch v·ª• sau: ‚úÖ Amazon Athena ‚úÖ Amazon S3 Cho S3, nh·∫•p Select S3 buckets Ch·ªçn bucket d·ªØ li·ªáu th·ªùi ti·∫øt: your-weather-processed-bucket your-athena-query-results-bucket Nh·∫•p Update B∆∞·ªõc 2: T·∫°o Data Source v√† Dataset 2.1 K·∫øt n·ªëi v·ªõi Athena Trong trang ch·ªß QuickSight, nh·∫•p Datasets Nh·∫•p New dataset Ch·ªçn Athena l√†m data source C·∫•u h√¨nh k·∫øt n·ªëi: Data source name: Weather-Data-Athena Athena workgroup: primary (m·∫∑c ƒë·ªãnh) Nh·∫•p Create data source 2.2 T·∫°o Dataset t·ª´ Weather Table Ch·ªçn database: weather_analytics Ch·ªçn table: current_weather Ch·ªçn Directly query your data Nh·∫•p Visualize N·∫øu dataset c·ªßa b·∫°n nh·ªè (\u0026lt; 1GB), b·∫°n c√≥ th·ªÉ ch·ªçn \u0026ldquo;Import to SPICE\u0026rdquo; ƒë·ªÉ c√≥ hi·ªáu su·∫•t t·ªët h∆°n. SPICE l√† engine t√≠nh to√°n trong b·ªô nh·ªõ c·ªßa QuickSight.\nB∆∞·ªõc 3: T·∫°o Tr·ª±c quan h√≥a Th·ªùi ti·∫øt 3.1 Bi·ªÉu ƒë·ªì ƒê∆∞·ªùng Xu h∆∞·ªõng Nhi·ªát ƒë·ªô T·∫°o ph√¢n t√≠ch m·ªõi:\nNh·∫•p + Add ‚Üí Add visual Ch·ªçn Line chart C·∫•u h√¨nh bi·ªÉu ƒë·ªì:\nX-axis: K√©o data_collection_date v√†o X-axis Value: K√©o temperature_celsius v√†o Value Color: K√©o city_name v√†o Color T√πy ch·ªânh bi·ªÉu ƒë·ªì:\nNh·∫•p visual ‚Üí Format visual Title: \u0026ldquo;Xu h∆∞·ªõng Nhi·ªát ƒë·ªô theo Th√†nh ph·ªë\u0026rdquo; Y-axis label: \u0026ldquo;Nhi·ªát ƒë·ªô (¬∞C)\u0026rdquo; Legend: ƒê·∫∑t ·ªü d∆∞·ªõi c√πng 3.2 Bi·ªÉu ƒë·ªì Tr√≤n ƒêi·ªÅu ki·ªán Th·ªùi ti·∫øt Th√™m visual m·ªõi:\nNh·∫•p + Add ‚Üí Add visual Ch·ªçn Pie chart C·∫•u h√¨nh bi·ªÉu ƒë·ªì:\nGroup/Color: K√©o weather_main v√†o Group/Color Value: K√©o city_name v√†o Value Aggregate: ƒê·ªïi th√†nh Count T√πy ch·ªânh:\nTitle: \u0026ldquo;Ph√¢n b·ªë ƒêi·ªÅu ki·ªán Th·ªùi ti·∫øt\u0026rdquo; Legend: Hi·ªÉn th·ªã ph·∫ßn trƒÉm 3.3 Bi·ªÉu ƒë·ªì C·ªôt So s√°nh Nhi·ªát ƒë·ªô Th√†nh ph·ªë Th√™m visual m·ªõi:\nCh·ªçn Vertical bar chart C·∫•u h√¨nh:\nX-axis: K√©o city_name v√†o X-axis Value: K√©o temperature_celsius v√†o Value Aggregate: ƒê·ªïi th√†nh Average T√πy ch·ªânh:\nTitle: \u0026ldquo;Nhi·ªát ƒë·ªô Trung b√¨nh theo Th√†nh ph·ªë\u0026rdquo; Y-axis label: \u0026ldquo;Nhi·ªát ƒë·ªô Trung b√¨nh (¬∞C)\u0026rdquo; S·∫Øp x·∫øp theo gi√° tr·ªã (gi·∫£m d·∫ßn) 3.4 Bi·ªÉu ƒë·ªì Ph√¢n t√°n ƒê·ªô ·∫©m vs Nhi·ªát ƒë·ªô Th√™m visual m·ªõi:\nCh·ªçn Scatter plot C·∫•u h√¨nh:\nX-axis: K√©o temperature_celsius v√†o X-axis Y-axis: K√©o humidity_percent v√†o Y-axis Color: K√©o comfort_level v√†o Color Size: K√©o pressure_hpa v√†o Size T√πy ch·ªânh:\nTitle: \u0026ldquo;T∆∞∆°ng quan ƒê·ªô ·∫©m v√† Nhi·ªát ƒë·ªô\u0026rdquo; X-axis label: \u0026ldquo;Nhi·ªát ƒë·ªô (¬∞C)\u0026rdquo; Y-axis label: \u0026ldquo;ƒê·ªô ·∫©m (%)\u0026rdquo; 3.5 Ch·ªâ s·ªë Hi·ªáu su·∫•t Ch√≠nh (KPIs) T·∫°o c√°c √¥ KPI cho d·ªØ li·ªáu th·ªùi ti·∫øt m·ªõi nh·∫•t:\nKPI Nhi·ªát ƒë·ªô Hi·ªán t·∫°i Th√™m visual m·ªõi ‚Üí KPI C·∫•u h√¨nh: Value: temperature_celsius Aggregate: Average Filter: Th√™m filter cho ng√†y m·ªõi nh·∫•t Title: \u0026ldquo;Nhi·ªát ƒë·ªô Trung b√¨nh Hi·ªán t·∫°i\u0026rdquo; KPI T·ªëc ƒë·ªô Gi√≥ Th√™m KPI visual C·∫•u h√¨nh: Value: wind_speed_kmh Aggregate: Average Title: \u0026ldquo;T·ªëc ƒë·ªô Gi√≥ Trung b√¨nh Hi·ªán t·∫°i\u0026rdquo; KPI ƒê·ªô ·∫©m Th√™m KPI visual C·∫•u h√¨nh: Value: humidity_percent Aggregate: Average Title: \u0026ldquo;ƒê·ªô ·∫©m Trung b√¨nh Hi·ªán t·∫°i\u0026rdquo; B∆∞·ªõc 4: X√¢y d·ª±ng Dashboard To√†n di·ªán 4.1 T·ªï ch·ª©c B·ªë c·ª•c Dashboard Thay ƒë·ªïi k√≠ch th∆∞·ªõc v√† s·∫Øp x·∫øp visuals:\nƒê·∫∑t KPIs ·ªü tr√™n c√πng theo h√†ng ngang Bi·ªÉu ƒë·ªì xu h∆∞·ªõng nhi·ªát ƒë·ªô ·ªü khu v·ª±c ch√≠nh Bi·ªÉu ƒë·ªì tr√≤n v√† bi·ªÉu ƒë·ªì c·ªôt c·∫°nh nhau b√™n d∆∞·ªõi Bi·ªÉu ƒë·ªì ph√¢n t√°n ·ªü d∆∞·ªõi c√πng Th√™m ti√™u ƒë·ªÅ dashboard:\nNh·∫•p + Add ‚Üí Add title Text: \u0026ldquo;Dashboard Ph√¢n t√≠ch Th·ªùi ti·∫øt\u0026rdquo; Style: L·ªõn, cƒÉn gi·ªØa 4.2 Th√™m B·ªô l·ªçc T∆∞∆°ng t√°c Th√™m b·ªô l·ªçc ng√†y:\nNh·∫•p Filter pane (b√™n tr√°i) Nh·∫•p Create one ‚Üí Ch·ªçn data_collection_date Filter type: Date range Default: 7 ng√†y g·∫ßn nh·∫•t Th√™m b·ªô l·ªçc th√†nh ph·ªë:\nT·∫°o filter cho city_name Filter type: Multi-select dropdown Hi·ªÉn th·ªã t·∫•t c·∫£ th√†nh ph·ªë theo m·∫∑c ƒë·ªãnh Th√™m b·ªô l·ªçc ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt:\nT·∫°o filter cho weather_main Filter type: Multi-select dropdown 4.3 √Åp d·ª•ng Styling Dashboard Ch·ªçn color theme:\nNh·∫•p Themes (menu tr√™n) Ch·ªçn Midnight ho·∫∑c Classic T√πy ch·ªânh m√†u s·∫Øc:\nCho bi·ªÉu ƒë·ªì nhi·ªát ƒë·ªô: S·ª≠ d·ª•ng gradient xanh-ƒë·ªè Cho ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt: S·ª≠ d·ª•ng m√†u ri√™ng bi·ªát cho m·ªói ƒëi·ªÅu ki·ªán Th√™m text m√¥ t·∫£:\nNh·∫•p + Add ‚Üí Add text box Th√™m insights ho·∫∑c h∆∞·ªõng d·∫´n cho ng∆∞·ªùi d√πng dashboard B∆∞·ªõc 5: Tr·ª±c quan h√≥a N√¢ng cao 5.1 T·∫°o Heat Map cho Nhi·ªát ƒë·ªô theo Th·ªùi gian Th√™m visual m·ªõi ‚Üí Heat map C·∫•u h√¨nh: Rows: city_name Columns: data_collection_date Values: temperature_celsius (Average) T√πy ch·ªânh: Title: \u0026ldquo;Heat Map Nhi·ªát ƒë·ªô theo Th√†nh ph·ªë v√† Ng√†y\u0026rdquo; Color scale: Xanh (l·∫°nh) ƒë·∫øn ƒê·ªè (n√≥ng) 5.2 Bi·ªÉu ƒë·ªì H∆∞·ªõng Gi√≥ (S·ª≠ d·ª•ng Calculated Fields) T·∫°o calculated field:\nNh·∫•p + Add ‚Üí Add calculated field Name: wind_direction_category Formula: ifelse(\rwind_direction_deg \u0026gt;= 337.5 OR wind_direction_deg \u0026lt; 22.5, \u0026#34;N\u0026#34;,\rwind_direction_deg \u0026gt;= 22.5 AND wind_direction_deg \u0026lt; 67.5, \u0026#34;NE\u0026#34;,\rwind_direction_deg \u0026gt;= 67.5 AND wind_direction_deg \u0026lt; 112.5, \u0026#34;E\u0026#34;,\rwind_direction_deg \u0026gt;= 112.5 AND wind_direction_deg \u0026lt; 157.5, \u0026#34;SE\u0026#34;,\rwind_direction_deg \u0026gt;= 157.5 AND wind_direction_deg \u0026lt; 202.5, \u0026#34;S\u0026#34;,\rwind_direction_deg \u0026gt;= 202.5 AND wind_direction_deg \u0026lt; 247.5, \u0026#34;SW\u0026#34;,\rwind_direction_deg \u0026gt;= 247.5 AND wind_direction_deg \u0026lt; 292.5, \u0026#34;W\u0026#34;,\r\u0026#34;NW\u0026#34;\r) T·∫°o bi·ªÉu ƒë·ªì h∆∞·ªõng gi√≥:\nVisual type: Donut chart Group: wind_direction_category Value: Count of records Title: \u0026ldquo;Ph√¢n b·ªë H∆∞·ªõng Gi√≥\u0026rdquo; 5.3 Gauge M·ª©c ƒë·ªô Nghi√™m tr·ªçng Th·ªùi ti·∫øt T·∫°o calculated field:\nName: severity_score Formula: ifelse(\rweather_severity = \u0026#34;nghi√™m_tr·ªçng\u0026#34;, 4,\rweather_severity = \u0026#34;v·ª´a\u0026#34;, 3,\rweather_severity = \u0026#34;nh·∫π\u0026#34;, 2,\r1\r) Th√™m gauge visual:\nValue: severity_score (Average) Title: \u0026ldquo;Ch·ªâ s·ªë M·ª©c ƒë·ªô Nghi√™m tr·ªçng Th·ªùi ti·∫øt\u0026rdquo; Range: 1-4 B∆∞·ªõc 6: Xu·∫•t b·∫£n v√† Chia s·∫ª Dashboard 6.1 Xu·∫•t b·∫£n Dashboard Nh·∫•p Share (g√≥c ph·∫£i tr√™n) Nh·∫•p Publish dashboard Dashboard name: \u0026ldquo;Dashboard Ph√¢n t√≠ch Th·ªùi ti·∫øt\u0026rdquo; Description: \u0026ldquo;Tr·ª±c quan h√≥a d·ªØ li·ªáu th·ªùi ti·∫øt t∆∞∆°ng t√°c hi·ªÉn th·ªã xu h∆∞·ªõng nhi·ªát ƒë·ªô, m·∫´u th·ªùi ti·∫øt v√† so s√°nh th√†nh ph·ªë\u0026rdquo; Nh·∫•p Publish dashboard 6.2 Thi·∫øt l·∫≠p Quy·ªÅn Chia s·∫ª Trong dashboard ƒë√£ xu·∫•t b·∫£n, nh·∫•p Share Add users or groups: Nh·∫≠p ƒë·ªãa ch·ªâ email c·ªßa ng∆∞·ªùi d√πng ƒë·ªÉ chia s·∫ª ƒê·∫∑t quy·ªÅn: Viewer ho·∫∑c Co-owner Nh·∫•p Share 6.3 T·∫°o Dashboard C√¥ng khai (T√πy ch·ªçn) Nh·∫•p Share ‚Üí Manage dashboard access K√≠ch ho·∫°t Make dashboard public Sao ch√©p URL c√¥ng khai ƒë·ªÉ chia s·∫ª b√™n ngo√†i Ch·ªâ c√¥ng khai dashboard n·∫øu d·ªØ li·ªáu th·ªùi ti·∫øt c·ªßa b·∫°n kh√¥ng ch·ª©a th√¥ng tin nh·∫°y c·∫£m.\nB∆∞·ªõc 7: Thi·∫øt l·∫≠p L√†m m·ªõi D·ªØ li·ªáu T·ª± ƒë·ªông 7.1 C·∫•u h√¨nh L√†m m·ªõi Dataset ƒêi ƒë·∫øn Datasets Ch·ªçn weather dataset c·ªßa b·∫°n Nh·∫•p Refresh ‚Üí Schedule refresh C·∫•u h√¨nh l·ªãch: Frequency: Daily Time: S√°ng s·ªõm (v√≠ d·ª•: 6 AM) Time zone: M√∫i gi·ªù ƒë·ªãa ph∆∞∆°ng c·ªßa b·∫°n L∆∞u l·ªãch 7.2 Gi√°m s√°t Tr·∫°ng th√°i L√†m m·ªõi Ki·ªÉm tra l·ªãch s·ª≠ l√†m m·ªõi trong Dataset settings Thi·∫øt l·∫≠p th√¥ng b√°o cho l√†m m·ªõi th·∫•t b·∫°i Gi√°m s√°t ch·ªâ b√°o ƒë·ªô t∆∞∆°i c·ªßa d·ªØ li·ªáu trong dashboard B∆∞·ªõc 8: T·ªëi ∆∞u h√≥a Dashboard v√† Best Practices 8.1 T·ªëi ∆∞u h√≥a Hi·ªáu su·∫•t S·ª≠ d·ª•ng SPICE cho hi·ªáu su·∫•t t·ªët h∆°n:\nImport d·ªØ li·ªáu v√†o SPICE n·∫øu dataset \u0026lt; 10GB L·∫≠p l·ªãch l√†m m·ªõi SPICE th∆∞·ªùng xuy√™n T·ªëi ∆∞u h√≥a truy v·∫•n:\nS·ª≠ d·ª•ng filter ƒë·ªÉ gi·∫£m vi·ªác qu√©t d·ªØ li·ªáu T·∫°o b·∫£ng t√≥m t·∫Øt trong Athena cho dataset l·ªõn Gi·ªõi h·∫°n ƒë·ªô ph·ª©c t·∫°p visual:\nT·ªëi ƒëa 15-20 ƒëi·ªÉm d·ªØ li·ªáu m·ªói bi·ªÉu ƒë·ªì S·ª≠ d·ª•ng drill-down cho view chi ti·∫øt 8.2 Best Practices Tr·∫£i nghi·ªám Ng∆∞·ªùi d√πng Th·ª© b·∫≠c visual r√µ r√†ng:\nC√°c metric quan tr·ªçng nh·∫•t ·ªü tr√™n C√°c visual li√™n quan ƒë∆∞·ª£c nh√≥m l·∫°i M√†u s·∫Øc nh·∫•t qu√°n C√°c y·∫øu t·ªë t∆∞∆°ng t√°c:\nCung c·∫•p h∆∞·ªõng d·∫´n filter r√µ r√†ng S·ª≠ d·ª•ng ph·∫°m vi ng√†y nh·∫•t qu√°n K√≠ch ho·∫°t cross-filtering gi·ªØa c√°c visual T√≠nh responsive di ƒë·ªông:\nKi·ªÉm tra dashboard tr√™n thi·∫øt b·ªã di ƒë·ªông ƒêi·ªÅu ch·ªânh layout cho m√†n h√¨nh nh·ªè h∆°n ∆Øu ti√™n metric ch√≠nh cho view di ƒë·ªông Kh·∫Øc ph·ª•c C√°c V·∫•n ƒë·ªÅ Th∆∞·ªùng g·∫∑p V·∫•n ƒë·ªÅ 1: L·ªói \u0026ldquo;Insufficient permissions\u0026rdquo; Gi·∫£i ph√°p: Ki·ªÉm tra quy·ªÅn IAM c·ªßa QuickSight cho truy c·∫≠p Athena v√† S3 X√°c minh quy·ªÅn bucket trong c√†i ƒë·∫∑t b·∫£o m·∫≠t QuickSight V·∫•n ƒë·ªÅ 2: D·ªØ li·ªáu Kh√¥ng L√†m m·ªõi Gi·∫£i ph√°p: Ki·ªÉm tra quy·ªÅn truy v·∫•n Athena X√°c minh tr·∫°ng th√°i k·∫øt n·ªëi data source Xem l·∫°i error logs c·ªßa l√†m m·ªõi V·∫•n ƒë·ªÅ 3: Hi·ªáu su·∫•t Dashboard Ch·∫≠m Gi·∫£i ph√°p: Import d·ªØ li·ªáu v√†o SPICE T·ªëi ∆∞u h√≥a truy v·∫•n Athena v·ªõi filtering ph√π h·ª£p Gi·∫£m s·ªë l∆∞·ª£ng visual m·ªói dashboard Ph√¢n t√≠ch Chi ph√≠ Chi ph√≠ QuickSight cho module n√†y:\nStandard Edition: $9/th√°ng m·ªói author (d√πng th·ª≠ mi·ªÖn ph√≠ 30 ng√†y) SPICE storage: $0.25/GB/th√°ng Enterprise Edition: $18/th√°ng m·ªói author (t√≠nh nƒÉng n√¢ng cao) T·ªïng chi ph√≠ ∆∞·ªõc t√≠nh: $0-4 trong th·ªùi gian d√πng th·ª≠ mi·ªÖn ph√≠\nBest Practices B·∫£o m·∫≠t Ki·ªÉm so√°t Truy c·∫≠p:\nS·ª≠ d·ª•ng IAM roles cho quy·ªÅn d·ªãch v·ª• Tri·ªÉn khai row-level security n·∫øu c·∫ßn Audit th∆∞·ªùng xuy√™n quy·ªÅn truy c·∫≠p ng∆∞·ªùi d√πng B·∫£o v·ªá D·ªØ li·ªáu:\nK√≠ch ho·∫°t m√£ h√≥a trong transit v√† at rest S·ª≠ d·ª•ng VPC endpoints cho k·∫øt n·ªëi ri√™ng t∆∞ Gi√°m s√°t patterns truy c·∫≠p d·ªØ li·ªáu C√°c b∆∞·ªõc ti·∫øp theo Sau khi ho√†n th√†nh module n√†y, b·∫°n s·∫Ω c√≥:\n‚úÖ Dashboard th·ªùi ti·∫øt t∆∞∆°ng t√°c v·ªõi nhi·ªÅu tr·ª±c quan h√≥a ‚úÖ L√†m m·ªõi d·ªØ li·ªáu t·ª± ƒë·ªông t·ª´ ETL pipeline ‚úÖ Insights c√≥ th·ªÉ chia s·∫ª cho ph√¢n t√≠ch th·ªùi ti·∫øt ‚úÖ Hi·ªÉu bi·∫øt v·ªÅ best practices c·ªßa QuickSight S·∫Øp t·ªõi trong Module 6: H·ªçc c√°ch d·ªçn d·∫πp ƒë√∫ng c√°ch c√°c t√†i nguy√™n AWS v√† kh√°m ph√° c√°c c·∫£i ti·∫øn n√¢ng cao cho n·ªÅn t·∫£ng ph√¢n t√≠ch th·ªùi ti·∫øt c·ªßa b·∫°n.\nL∆∞u dashboard c·ªßa b·∫°n d∆∞·ªõi d·∫°ng template ƒë·ªÉ nhanh ch√≥ng t·∫°o dashboard t∆∞∆°ng t·ª± cho c√°c dataset ho·∫∑c th·ªùi gian kh√°c nhau.\nQuickSight cung c·∫•p insights ƒë∆∞·ª£c h·ªó tr·ª£ ML. H√£y th·ª≠ t√≠nh nƒÉng ML Insights ƒë·ªÉ t·ª± ƒë·ªông kh√°m ph√° anomalies v√† trends trong d·ªØ li·ªáu th·ªùi ti·∫øt c·ªßa b·∫°n.\nNh·ªõ h·ªßy ƒëƒÉng k√Ω QuickSight sau workshop n·∫øu b·∫°n kh√¥ng c√≥ k·∫ø ho·∫°ch ti·∫øp t·ª•c s·ª≠ d·ª•ng ƒë·ªÉ tr√°nh c√°c kho·∫£n ph√≠ li√™n t·ª•c.\n"
},
{
	"uri": "//localhost:1313/vi/6-cleanup-next-steps/",
	"title": "D·ªçn d·∫πp T√†i nguy√™n v√† B∆∞·ªõc ti·∫øp theo",
	"tags": [],
	"description": "",
	"content": "D·ªçn d·∫πp T√†i nguy√™n v√† B∆∞·ªõc ti·∫øp theo Ch√∫c m·ª´ng b·∫°n ƒë√£ x√¢y d·ª±ng xong pipeline ETL th·ªùi ti·∫øt serverless ho√†n ch·ªânh! Module cu·ªëi c√πng n√†y t·∫≠p trung v√†o vi·ªác d·ªçn d·∫πp ƒë√∫ng c√°ch t·∫•t c·∫£ t√†i nguy√™n AWS ƒë·ªÉ tr√°nh c√°c kho·∫£n ph√≠ li√™n t·ª•c v√† kh√°m ph√° c√°c c∆° h·ªôi c·∫£i ti·∫øn th√™m.\nT·ªïng quan Module Sau khi ho√†n th√†nh workshop th·ª±c h√†nh, vi·ªác d·ªçn d·∫πp t√†i nguy√™n l√† r·∫•t quan tr·ªçng ƒë·ªÉ ngƒÉn ng·ª´a c√°c kho·∫£n ph√≠ b·∫•t ng·ªù. Module n√†y cung c·∫•p c√°c th·ªß t·ª•c d·ªçn d·∫πp to√†n di·ªán v√† g·ª£i √Ω c√°c b∆∞·ªõc ti·∫øp theo ƒë·ªÉ m·ªü r·ªông pipeline th·ªùi ti·∫øt c·ªßa b·∫°n.\nM·ª•c ti√™u H·ªçc t·∫≠p Sau khi ho√†n th√†nh module n√†y, b·∫°n s·∫Ω:\nHi·ªÉu t·∫ßm quan tr·ªçng c·ªßa vi·ªác d·ªçn d·∫πp t√†i nguy√™n trong AWS Th·ª±c hi·ªán c√°c th·ªß t·ª•c d·ªçn d·∫πp to√†n di·ªán cho t·∫•t c·∫£ t√†i nguy√™n ƒë√£ t·∫°o H·ªçc c√°c chi·∫øn l∆∞·ª£c t·ªëi ∆∞u chi ph√≠ cho c√°c d·ª± √°n t∆∞∆°ng lai Kh√°m ph√° c√°c t√≠nh nƒÉng n√¢ng cao v√† c·∫£i ti·∫øn cho pipeline c·ªßa b·∫°n Kh√°m ph√° c√°c t√†i nguy√™n h·ªçc t·∫≠p b·ªï sung T·∫ßm quan tr·ªçng c·ªßa D·ªçn d·∫πp D·ªçn d·∫πp ƒë√∫ng c√°ch l√† c·∫ßn thi·∫øt v√¨:\nQu·∫£n l√Ω Chi ph√≠: NgƒÉn ng·ª´a c√°c kho·∫£n ph√≠ b·∫•t ng·ªù t·ª´ t√†i nguy√™n kh√¥ng s·ª≠ d·ª•ng B·∫£o m·∫≠t: Lo·∫°i b·ªè c√°c quy·ªÅn v√† ƒëi·ªÉm truy c·∫≠p kh√¥ng s·ª≠ d·ª•ng Best Practices: Thi·∫øt l·∫≠p th√≥i quen qu·∫£n l√Ω t√†i nguy√™n AWS t·ªët V·ªá sinh T√†i kho·∫£n: Gi·ªØ t√†i kho·∫£n AWS c·ªßa b·∫°n c√≥ t·ªï ch·ª©c v√† d·ªÖ qu·∫£n l√Ω Danh s√°ch Ki·ªÉm tra D·ªçn d·∫πp Ho√†n ch·ªânh 6.1 T√†i nguy√™n QuickSight ∆Øu ti√™n: Cao (Chi ph√≠ ƒëƒÉng k√Ω li√™n t·ª•c)\nX√≥a Dashboard\nLo·∫°i b·ªè dashboard th·ªùi ti·∫øt c·ªßa b·∫°n X√≥a m·ªçi phi√™n b·∫£n ƒë√£ chia s·∫ª X√≥a Dataset\nLo·∫°i b·ªè dataset d·ªØ li·ªáu th·ªùi ti·∫øt X√≥a m·ªçi d·ªØ li·ªáu cached H·ªßy ƒêƒÉng k√Ω (n·∫øu kh√¥ng c√≤n c·∫ßn thi·∫øt)\nH·∫° c·∫•p t·ª´ Author xu·ªëng Reader H·ªßy ƒëƒÉng k√Ω ƒë·ªÉ tr√°nh ph√≠ h√†ng th√°ng 6.2 T√†i nguy√™n Athena ∆Øu ti√™n: Trung b√¨nh (L∆∞u tr·ªØ k·∫øt qu·∫£ truy v·∫•n)\nDrop Tables\nDROP TABLE weather_data_processed; DROP TABLE weather_data_raw; Drop Database\nDROP DATABASE weather_analytics; D·ªçn d·∫πp K·∫øt qu·∫£ Truy v·∫•n\nX√≥a c√°c file k·∫øt qu·∫£ truy v·∫•n Athena t·ª´ S3 6.3 S3 Bucket v√† D·ªØ li·ªáu ∆Øu ti√™n: Cao (Chi ph√≠ l∆∞u tr·ªØ)\nX√≥a Raw Data Bucket\naws s3 rm s3://weather-data-raw-[YOUR-ID] --recursive aws s3 rb s3://weather-data-raw-[YOUR-ID] X√≥a Processed Data Bucket\naws s3 rm s3://weather-data-processed-[YOUR-ID] --recursive aws s3 rb s3://weather-data-processed-[YOUR-ID] X√≥a Athena Results Bucket\naws s3 rm s3://aws-athena-query-results-[ACCOUNT-ID]-[REGION] --recursive 6.4 Lambda Function ∆Øu ti√™n: Trung b√¨nh (Chi ph√≠ li√™n t·ª•c t·ªëi thi·ªÉu)\nX√≥a Weather Collector Function\naws lambda delete-function --function-name weather-data-collector X√≥a Weather Processor Function\naws lambda delete-function --function-name weather-data-processor Lo·∫°i b·ªè Function Trigger\nX√≥a EventBridge rules Lo·∫°i b·ªè S3 event notification 6.5 T√†i nguy√™n CloudWatch ∆Øu ti√™n: Th·∫•p (Free tier bao g·ªìm h·∫ßu h·∫øt vi·ªác s·ª≠ d·ª•ng)\nX√≥a Log Group\naws logs delete-log-group --log-group-name /aws/lambda/weather-data-collector aws logs delete-log-group --log-group-name /aws/lambda/weather-data-processor X√≥a EventBridge Rule\naws events delete-rule --name weather-collection-schedule Lo·∫°i b·ªè Custom Metric (n·∫øu c√≥)\n6.6 IAM Role v√† Policy ∆Øu ti√™n: Trung b√¨nh (B·∫£o m·∫≠t v√† t·ªï ch·ª©c)\nDetach Policy t·ª´ Role\naws iam detach-role-policy --role-name weather-lambda-role --policy-arn arn:aws:iam::aws:policy/AmazonS3FullAccess aws iam detach-role-policy --role-name weather-lambda-role --policy-arn arn:aws:iam::aws:policy/CloudWatchLogsFullAccess X√≥a IAM Role\naws iam delete-role --role-name weather-lambda-role aws iam delete-role --role-name quicksight-athena-role Lo·∫°i b·ªè Custom Policy (n·∫øu ƒë√£ t·∫°o)\n6.7 Systems Manager Parameter ∆Øu ti√™n: Th·∫•p (Kh√¥ng c√≥ chi ph√≠ li√™n t·ª•c)\nX√≥a Parameter Store Value aws ssm delete-parameter --name /weather-etl/openweathermap/api-key T√≥m t·∫Øt Chi ph√≠ Cu·ªëi c√πng Sau khi ho√†n th√†nh d·ªçn d·∫πp, t·ªïng chi ph√≠ workshop ∆∞·ªõc t√≠nh c·ªßa b·∫°n s·∫Ω l√†:\nLambda Execution: ~$0.10 (trong Free Tier) S3 Storage: ~$0.20 (d·ªØ li·ªáu t·ªëi thi·ªÉu ƒë∆∞·ª£c l∆∞u tr·ªØ) Athena Queries: ~$0.15 (truy v·∫•n dataset nh·ªè) QuickSight: ~$3-4 (n·∫øu s·ª≠ d·ª•ng free trial) Data Transfer: ~$0.05 (t·ªëi thi·ªÉu) T·ªïng Chi ph√≠ Workshop: D∆∞·ªõi $5 (kh√¥ng bao g·ªìm ƒëƒÉng k√Ω QuickSight)\nB∆∞·ªõc ti·∫øp theo v√† C·∫£i ti·∫øn C·∫£i ti·∫øn Ngay l·∫≠p t·ª©c Thu th·∫≠p D·ªØ li·ªáu N√¢ng cao\nTh√™m nhi·ªÅu th√†nh ph·ªë v√† th√¥ng s·ªë th·ªùi ti·∫øt Tri·ªÉn khai x·ª≠ l√Ω l·ªói v√† retry Th√™m x√°c th·ª±c v√† ki·ªÉm tra ch·∫•t l∆∞·ª£ng d·ªØ li·ªáu X·ª≠ l√Ω N√¢ng cao\nTri·ªÉn khai t·ªïng h·ª£p d·ªØ li·ªáu v√† xu h∆∞·ªõng Th√™m c·∫£nh b√°o v√† th√¥ng b√°o th·ªùi ti·∫øt Bao g·ªìm so s√°nh th·ªùi ti·∫øt l·ªãch s·ª≠ Ph√¢n t√≠ch T·ªët h∆°n\nT·∫°o truy v·∫•n Athena ph·ª©c t·∫°p h∆°n Tri·ªÉn khai d·ª± ƒëo√°n machine learning Th√™m ph√¢n t√≠ch streaming real-time C√¢n nh·∫Øc Production C·∫£i ti·∫øn B·∫£o m·∫≠t\nTri·ªÉn khai IAM policy least-privilege Th√™m m√£ h√≥a khi l∆∞u tr·ªØ v√† truy·ªÅn t·∫£i S·ª≠ d·ª•ng AWS Secrets Manager cho API key Gi√°m s√°t v√† C·∫£nh b√°o\nThi·∫øt l·∫≠p CloudWatch dashboard to√†n di·ªán Tri·ªÉn khai SNS notification cho l·ªói Th√™m custom metric v√† alarm T·ªëi ∆∞u h√≥a Hi·ªáu su·∫•t\nT·ªëi ∆∞u h√≥a b·ªô nh·ªõ v√† timeout setting Lambda Tri·ªÉn khai S3 lifecycle policy Th√™m caching layer khi th√≠ch h·ª£p T√†i nguy√™n H·ªçc t·∫≠p AWS Documentation: T√¨m hi·ªÉu s√¢u h∆°n v·ªÅ c√°c d·ªãch v·ª• c·ª• th·ªÉ AWS Training: Tham gia c√°c kh√≥a h·ªçc AWS ch√≠nh th·ª©c v·ªÅ data engineering Community: Tham gia di·ªÖn ƒë√†n v√† nh√≥m ng∆∞·ªùi d√πng AWS Certification: C√¢n nh·∫Øc AWS Certified Data Analytics specialty B∆∞·ªõc X√°c minh Sau khi d·ªçn d·∫πp, x√°c minh m·ªçi th·ª© ƒë√£ ƒë∆∞·ª£c lo·∫°i b·ªè:\nKi·ªÉm tra AWS Console\nXem l·∫°i t·ª´ng service console ƒë·ªÉ t√¨m t√†i nguy√™n c√≤n l·∫°i Ki·ªÉm tra billing dashboard cho c√°c kho·∫£n ph√≠ li√™n t·ª•c X√°c minh CLI\naws s3 ls | grep weather aws lambda list-functions | grep weather aws iam list-roles | grep weather Gi√°m s√°t Chi ph√≠\nThi·∫øt l·∫≠p billing alert cho c√°c d·ª± √°n t∆∞∆°ng lai Xem l·∫°i AWS Cost Explorer cho b·∫•t k·ª≥ kho·∫£n ph√≠ b·∫•t ng·ªù n√†o K·∫øt lu·∫≠n B·∫°n ƒë√£ x√¢y d·ª±ng th√†nh c√¥ng v√† gi·ªù ƒë√¢y d·ªçn d·∫πp m·ªôt pipeline ETL th·ªùi ti·∫øt serverless ho√†n ch·ªânh! Tr·∫£i nghi·ªám n√†y cung c·∫•p n·ªÅn t·∫£ng v·ªØng ch·∫Øc ƒë·ªÉ x√¢y d·ª±ng c√°c h·ªá th·ªëng x·ª≠ l√Ω d·ªØ li·ªáu ph·ª©c t·∫°p h∆°n.\nƒêi·ªÉm ch√≠nh:\nKi·∫øn tr√∫c serverless ti·∫øt ki·ªám chi ph√≠ v√† c√≥ th·ªÉ m·ªü r·ªông D·ªçn d·∫πp t√†i nguy√™n ƒë√∫ng c√°ch l√† c·∫ßn thi·∫øt cho qu·∫£n l√Ω chi ph√≠ AWS cung c·∫•p c√°c c√¥ng c·ª• m·∫°nh m·∫Ω cho thu th·∫≠p, x·ª≠ l√Ω v√† tr·ª±c quan h√≥a d·ªØ li·ªáu Pipeline ETL c√≥ th·ªÉ ƒë∆∞·ª£c x√¢y d·ª±ng t·ª´ng b∆∞·ªõc v√† ki·ªÉm tra ·ªü m·ªói giai ƒëo·∫°n C·∫£m ∆°n b·∫°n ƒë√£ ho√†n th√†nh workshop n√†y! C√°c k·ªπ nƒÉng b·∫°n ƒë√£ h·ªçc c√≥ th·ªÉ ƒë∆∞·ª£c √°p d·ª•ng cho nhi·ªÅu th√°ch th·ª©c data engineering trong th·∫ø gi·ªõi th·ª±c.\nWorkshop Ho√†n th√†nh - Nh·ªõ x√°c minh t·∫•t c·∫£ t√†i nguy√™n ƒë√£ ƒë∆∞·ª£c d·ªçn d·∫πp ƒë·ªÉ tr√°nh c√°c kho·∫£n ph√≠ b·∫•t ng·ªù.\n"
},
{
	"uri": "//localhost:1313/vi/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "//localhost:1313/vi/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]