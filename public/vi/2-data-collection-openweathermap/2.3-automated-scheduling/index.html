<!DOCTYPE html>
<html lang="vi" class="js csstransforms3d">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.147.8">
    <meta name="description" content="Build a complete weather data ETL pipeline using AWS Lambda, S3, Athena, and QuickSight">
<meta name="author" content="Dang Van Huy">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Lập lịch Tự động với CloudWatch Events :: Hệ thống ETL Dữ liệu Thời tiết với AWS</title>

    
    <link href="/css/nucleus.css?1752216386" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1752216386" rel="stylesheet">
    <link href="/css/hybrid.css?1752216386" rel="stylesheet">
    <link href="/css/featherlight.min.css?1752216386" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1752216386" rel="stylesheet">
    <link href="/css/auto-complete.css?1752216386" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1752216386" rel="stylesheet">
    <link href="/css/theme.css?1752216386" rel="stylesheet">
    <link href="/css/hugo-theme.css?1752216386" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1752216386" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1752216386"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/vi/2-data-collection-openweathermap/2.3-automated-scheduling/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1752216386"></script>
<script type="text/javascript" src="/js/auto-complete.js?1752216386"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/localhost:1313\/\/vi";
    
</script>
<script type="text/javascript" src="/js/search.js?1752216386"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/vi/1-introduction/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduction/">
          <b>1. </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/2-data-collection-openweathermap/" title="Thu thập Dữ liệu Thời tiết với OpenWeatherMap" class="dd-item 
        parent
        
        
        ">
      <a href="/vi/2-data-collection-openweathermap/">
          <b>2. </b>Thu thập Dữ liệu Thời tiết với OpenWeatherMap
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/2-data-collection-openweathermap/2.1-openweathermap-setup/" title="Thiết lập OpenWeatherMap API" class="dd-item 
        
        
        
        ">
      <a href="/vi/2-data-collection-openweathermap/2.1-openweathermap-setup/">
          Thiết lập OpenWeatherMap API
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-data-collection-openweathermap/2.2-lambda-weather-collector/" title="Xây dựng Lambda Weather Collector" class="dd-item 
        
        
        
        ">
      <a href="/vi/2-data-collection-openweathermap/2.2-lambda-weather-collector/">
          Xây dựng Lambda Weather Collector
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-data-collection-openweathermap/2.3-automated-scheduling/" title="Lập lịch Tự động với CloudWatch Events" class="dd-item 
        
        active
        
        ">
      <a href="/vi/2-data-collection-openweathermap/2.3-automated-scheduling/">
          Lập lịch Tự động với CloudWatch Events
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-data-collection-openweathermap/2.4-testing-monitoring/" title="Testing và Monitoring Thu thập Thời tiết" class="dd-item 
        
        
        
        ">
      <a href="/vi/2-data-collection-openweathermap/2.4-testing-monitoring/">
          Testing và Monitoring Thu thập Thời tiết
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/3-serverless-processing-lambda/" title="Xử lý và Chuyển đổi Dữ liệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/3-serverless-processing-lambda/">
          <b>3. </b>Xử lý và Chuyển đổi Dữ liệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/4-data-storage-solutions/" title="Phân tích Dữ liệu với Athena" class="dd-item 
        
        
        
        ">
      <a href="/vi/4-data-storage-solutions/">
          <b>4. </b>Phân tích Dữ liệu với Athena
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/5-analytics-visualization/" title="Trực quan hóa Dữ liệu với QuickSight" class="dd-item 
        
        
        
        ">
      <a href="/vi/5-analytics-visualization/">
          <b>5. </b>Trực quan hóa Dữ liệu với QuickSight
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/6-cleanup-next-steps/" title="Dọn dẹp Tài nguyên và Bước tiếp theo" class="dd-item 
        
        
        
        ">
      <a href="/vi/6-cleanup-next-steps/">
          <b>6. </b>Dọn dẹp Tài nguyên và Bước tiếp theo
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="http://awsstudygroup.com"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="//localhost:1313/2-data-collection-openweathermap/2.3-automated-scheduling/">English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="//localhost:1313/vi/2-data-collection-openweathermap/2.3-automated-scheduling/" selected>Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
     
    
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>23-06-2025</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Author </b> <br>
           
            <i>
                <a href="https://www.linkedin.com/in/imvhuy/"  style="color:orange">Đặng Văn Huy</a>
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/vi/'>Xây dựng Pipeline ETL Thời tiết Serverless</a> > <a href='/vi/2-data-collection-openweathermap/'>Thu thập Dữ liệu Thời tiết với OpenWeatherMap</a> > Lập lịch Tự động với CloudWatch Events
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#tổng-quan-kiến-trúc">Tổng quan Kiến trúc</a></li>
    <li><a href="#bước-1-tạo-cloudwatch-events-rules">Bước 1: Tạo CloudWatch Events Rules</a>
      <ul>
        <li><a href="#11-lịch-trình-cho-current-weather-collection">1.1 Lịch trình cho Current Weather Collection</a></li>
        <li><a href="#12-lịch-trình-cho-weather-forecast-collection">1.2 Lịch trình cho Weather Forecast Collection</a></li>
      </ul>
    </li>
    <li><a href="#bước-2-tùy-chọn-lập-lịch-nâng-cao">Bước 2: Tùy chọn Lập lịch Nâng cao</a>
      <ul>
        <li><a href="#21-sử-dụng-cron-expressions">2.1 Sử dụng Cron Expressions</a></li>
        <li><a href="#22-lịch-trình-khác-nhau-cho-các-thành-phố-khác-nhau">2.2 Lịch trình Khác nhau cho Các Thành phố Khác nhau</a></li>
      </ul>
    </li>
    <li><a href="#bước-3-tạo-sns-topic-cho-thông-báo">Bước 3: Tạo SNS Topic cho Thông báo</a>
      <ul>
        <li><a href="#31-thiết-lập-sns-topic">3.1 Thiết lập SNS Topic</a></li>
        <li><a href="#32-sns-topic-policy">3.2 SNS Topic Policy</a></li>
      </ul>
    </li>
    <li><a href="#bước-4-thiết-lập-monitoring-và-alarms">Bước 4: Thiết lập Monitoring và Alarms</a>
      <ul>
        <li><a href="#41-lambda-function-alarms">4.1 Lambda Function Alarms</a></li>
        <li><a href="#42-custom-metrics-alarms">4.2 Custom Metrics Alarms</a></li>
      </ul>
    </li>
    <li><a href="#bước-5-cloudwatch-dashboard">Bước 5: CloudWatch Dashboard</a>
      <ul>
        <li><a href="#51-tạo-weather-etl-dashboard">5.1 Tạo Weather ETL Dashboard</a></li>
        <li><a href="#52-dashboard-widgets">5.2 Dashboard Widgets</a></li>
      </ul>
    </li>
    <li><a href="#bước-6-cost-optimization">Bước 6: Cost Optimization</a>
      <ul>
        <li><a href="#61-optimized-scheduling-strategy">6.1 Optimized Scheduling Strategy</a></li>
        <li><a href="#62-regional-data-collection">6.2 Regional Data Collection</a></li>
      </ul>
    </li>
    <li><a href="#bước-7-testing-scheduled-execution">Bước 7: Testing Scheduled Execution</a>
      <ul>
        <li><a href="#71-verify-rule-execution">7.1 Verify Rule Execution</a></li>
        <li><a href="#72-manual-rule-testing">7.2 Manual Rule Testing</a></li>
      </ul>
    </li>
    <li><a href="#troubleshooting">Troubleshooting</a>
      <ul>
        <li><a href="#73-common-issues">7.3 Common Issues</a></li>
      </ul>
    </li>
    <li><a href="#tóm-tắt">Tóm tắt</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Lập lịch Tự động với CloudWatch Events
            </h1>
          

        



	<h1 id="lập-lịch-tự-động-với-cloudwatch-events">Lập lịch Tự động với CloudWatch Events</h1>
<p>Trong phần này, chúng ta sẽ thiết lập lập lịch tự động cho việc thu thập dữ liệu thời tiết bằng Amazon CloudWatch Events (giờ được gọi là Amazon EventBridge). Điều này sẽ đảm bảo các Lambda functions chạy theo lịch trình đều đặn để thu thập dữ liệu thời tiết một cách nhất quán.</p>
<h2 id="tổng-quan-kiến-trúc">Tổng quan Kiến trúc</h2>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">graph TD
    A[CloudWatch Events Rules] --&gt; B[Current Weather Schedule&lt;br/&gt;Mỗi Giờ]
    A --&gt; C[Forecast Schedule&lt;br/&gt;Mỗi 6 Giờ]
    B --&gt; D[Lambda: weather-current-collector]
    C --&gt; E[Lambda: weather-forecast-collector]
    D --&gt; F[S3: Current Weather Data]
    E --&gt; G[S3: Forecast Data]
    H[CloudWatch Alarms] --&gt; I[SNS Notifications]

    style A fill:#e8f5e8
    style D fill:#ff9900,stroke:#232f3e,stroke-width:3px
    style E fill:#ff9900,stroke:#232f3e,stroke-width:3px
</code></pre><h2 id="bước-1-tạo-cloudwatch-events-rules">Bước 1: Tạo CloudWatch Events Rules</h2>
<h3 id="11-lịch-trình-cho-current-weather-collection">1.1 Lịch trình cho Current Weather Collection</h3>
<ol>
<li>
<p><strong>Điều hướng đến CloudWatch Console</strong></p>
<ul>
<li>AWS Console → CloudWatch → Events → Rules</li>
<li>Click &ldquo;Create rule&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Cấu hình Event Source</strong></p>
<ul>
<li><strong>Event Source</strong>: Schedule</li>
<li><strong>Schedule Expression</strong>: <code>rate(1 hour)</code></li>
<li><strong>Description</strong>: &ldquo;Trigger current weather collection every hour&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Cấu hình Target</strong></p>
<ul>
<li><strong>Target</strong>: Lambda function</li>
<li><strong>Function</strong>: <code>weather-current-collector</code></li>
<li><strong>Configure input</strong>: Constant (JSON text)</li>
</ul>
</li>
</ol>
<p><strong>Input JSON</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;source&#34;</span>: <span style="color:#e6db74">&#34;cloudwatch-events&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;detail-type&#34;</span>: <span style="color:#e6db74">&#34;Scheduled Event&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;detail&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;collection_type&#34;</span>: <span style="color:#e6db74">&#34;current_weather&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;scheduled_time&#34;</span>: <span style="color:#e6db74">&#34;hourly&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="4">
<li><strong>Chi tiết Rule</strong>
<ul>
<li><strong>Name</strong>: <code>weather-current-hourly</code></li>
<li><strong>Description</strong>: &ldquo;Thu thập dữ liệu thời tiết hiện tại hàng giờ cho 6 thành phố&rdquo;</li>
<li><strong>State</strong>: Enabled</li>
</ul>
</li>
</ol>
<h3 id="12-lịch-trình-cho-weather-forecast-collection">1.2 Lịch trình cho Weather Forecast Collection</h3>
<ol>
<li>
<p><strong>Tạo Rule thứ hai</strong></p>
<ul>
<li><strong>Event Source</strong>: Schedule</li>
<li><strong>Schedule Expression</strong>: <code>rate(6 hours)</code></li>
<li><strong>Description</strong>: &ldquo;Trigger weather forecast collection every 6 hours&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Cấu hình Target</strong></p>
<ul>
<li><strong>Target</strong>: Lambda function</li>
<li><strong>Function</strong>: <code>weather-forecast-collector</code></li>
</ul>
</li>
</ol>
<p><strong>Input JSON</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;source&#34;</span>: <span style="color:#e6db74">&#34;cloudwatch-events&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;detail-type&#34;</span>: <span style="color:#e6db74">&#34;Scheduled Event&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;detail&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;collection_type&#34;</span>: <span style="color:#e6db74">&#34;forecast&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;scheduled_time&#34;</span>: <span style="color:#e6db74">&#34;every_6_hours&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="3">
<li><strong>Chi tiết Rule</strong>
<ul>
<li><strong>Name</strong>: <code>weather-forecast-6hourly</code></li>
<li><strong>Description</strong>: &ldquo;Thu thập dữ liệu dự báo thời tiết 6 giờ một lần&rdquo;</li>
<li><strong>State</strong>: Enabled</li>
</ul>
</li>
</ol>
<h2 id="bước-2-tùy-chọn-lập-lịch-nâng-cao">Bước 2: Tùy chọn Lập lịch Nâng cao</h2>
<h3 id="21-sử-dụng-cron-expressions">2.1 Sử dụng Cron Expressions</h3>
<p>Để lập lịch chính xác hơn, bạn có thể sử dụng cron expressions:</p>
<p><strong>Current Weather tại các thời điểm cụ thể</strong>:</p>
<pre tabindex="0"><code>cron(0 0,6,12,18 * * ? *)
</code></pre><p>Chạy lúc 00:00, 06:00, 12:00, và 18:00 UTC hàng ngày.</p>
<p><strong>Forecast lúc 06:00 và 18:00 UTC</strong>:</p>
<pre tabindex="0"><code>cron(0 6,18 * * ? *)
</code></pre><p><strong>Hàng giờ trong giờ làm việc (UTC+7)</strong>:</p>
<pre tabindex="0"><code>cron(0 1-14 * * ? *)
</code></pre><p>Chạy hàng giờ từ 01:00 đến 14:00 UTC (08:00 đến 21:00 giờ Việt Nam).</p>
<h3 id="22-lịch-trình-khác-nhau-cho-các-thành-phố-khác-nhau">2.2 Lịch trình Khác nhau cho Các Thành phố Khác nhau</h3>
<p><strong>Tạo các rules theo thành phố</strong>:</p>
<p><strong>Rule cho Các Thành phố Châu Á (UTC+7/+8)</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;source&#34;</span>: <span style="color:#e6db74">&#34;cloudwatch-events&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;detail&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;cities&#34;</span>: [<span style="color:#e6db74">&#34;Ho Chi Minh City&#34;</span>, <span style="color:#e6db74">&#34;Hanoi&#34;</span>, <span style="color:#e6db74">&#34;Singapore&#34;</span>, <span style="color:#e6db74">&#34;Bangkok&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;timezone&#34;</span>: <span style="color:#e6db74">&#34;Asia/Ho_Chi_Minh&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Schedule</strong>: <code>cron(0 1,7,13,19 * * ? *)</code> (Giờ cao điểm ở châu Á)</p>
<h2 id="bước-3-tạo-sns-topic-cho-thông-báo">Bước 3: Tạo SNS Topic cho Thông báo</h2>
<h3 id="31-thiết-lập-sns-topic">3.1 Thiết lập SNS Topic</h3>
<ol>
<li>
<p><strong>Điều hướng đến SNS Console</strong></p>
<ul>
<li>AWS Console → SNS → Topics</li>
<li>Click &ldquo;Create topic&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Cấu hình Topic</strong></p>
<ul>
<li><strong>Type</strong>: Standard</li>
<li><strong>Name</strong>: <code>weather-collection-alerts</code></li>
<li><strong>Display Name</strong>: &ldquo;Weather Collection Alerts&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Tạo Subscription</strong></p>
<ul>
<li><strong>Protocol</strong>: Email</li>
<li><strong>Endpoint</strong>: Địa chỉ email của bạn</li>
<li>Xác nhận subscription qua email</li>
</ul>
</li>
</ol>
<h3 id="32-sns-topic-policy">3.2 SNS Topic Policy</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Statement&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;Sid&#34;</span>: <span style="color:#e6db74">&#34;AllowCloudWatchAlarmsToPublish&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;Principal&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;Service&#34;</span>: <span style="color:#e6db74">&#34;cloudwatch.amazonaws.com&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;Action&#34;</span>: <span style="color:#e6db74">&#34;SNS:Publish&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;Resource&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:sns:us-east-1:123456789012:weather-collection-alerts&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="bước-4-thiết-lập-monitoring-và-alarms">Bước 4: Thiết lập Monitoring và Alarms</h2>
<h3 id="41-lambda-function-alarms">4.1 Lambda Function Alarms</h3>
<p><strong>Error Rate Alarm</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AlarmName&#34;</span>: <span style="color:#e6db74">&#34;WeatherCollection-HighErrorRate&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AlarmDescription&#34;</span>: <span style="color:#e6db74">&#34;Tỷ lệ lỗi cao trong các functions thu thập thời tiết&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;MetricName&#34;</span>: <span style="color:#e6db74">&#34;Errors&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Namespace&#34;</span>: <span style="color:#e6db74">&#34;AWS/Lambda&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Statistic&#34;</span>: <span style="color:#e6db74">&#34;Sum&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Period&#34;</span>: <span style="color:#ae81ff">3600</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;EvaluationPeriods&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Threshold&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;ComparisonOperator&#34;</span>: <span style="color:#e6db74">&#34;GreaterThanOrEqualToThreshold&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Dimensions&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;Name&#34;</span>: <span style="color:#e6db74">&#34;FunctionName&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;Value&#34;</span>: <span style="color:#e6db74">&#34;weather-current-collector&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AlarmActions&#34;</span>: [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;arn:aws:sns:us-east-1:123456789012:weather-collection-alerts&#34;</span>
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Duration Alarm</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AlarmName&#34;</span>: <span style="color:#e6db74">&#34;WeatherCollection-LongDuration&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AlarmDescription&#34;</span>: <span style="color:#e6db74">&#34;Thời gian thực thi Lambda quá lâu&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;MetricName&#34;</span>: <span style="color:#e6db74">&#34;Duration&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Namespace&#34;</span>: <span style="color:#e6db74">&#34;AWS/Lambda&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Statistic&#34;</span>: <span style="color:#e6db74">&#34;Average&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Period&#34;</span>: <span style="color:#ae81ff">300</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;EvaluationPeriods&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Threshold&#34;</span>: <span style="color:#ae81ff">240000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;ComparisonOperator&#34;</span>: <span style="color:#e6db74">&#34;GreaterThanThreshold&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Unit&#34;</span>: <span style="color:#e6db74">&#34;Milliseconds&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="42-custom-metrics-alarms">4.2 Custom Metrics Alarms</h3>
<p><strong>Collection Success Rate</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AlarmName&#34;</span>: <span style="color:#e6db74">&#34;WeatherCollection-LowSuccessRate&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AlarmDescription&#34;</span>: <span style="color:#e6db74">&#34;Tỷ lệ thành công thu thập thấp&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;MetricName&#34;</span>: <span style="color:#e6db74">&#34;SuccessfulCollections&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Namespace&#34;</span>: <span style="color:#e6db74">&#34;Weather/ETL&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Statistic&#34;</span>: <span style="color:#e6db74">&#34;Sum&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Period&#34;</span>: <span style="color:#ae81ff">3600</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;EvaluationPeriods&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Threshold&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;ComparisonOperator&#34;</span>: <span style="color:#e6db74">&#34;LessThanThreshold&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>API Call Failures</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AlarmName&#34;</span>: <span style="color:#e6db74">&#34;WeatherAPI-HighFailureRate&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AlarmDescription&#34;</span>: <span style="color:#e6db74">&#34;Tỷ lệ thất bại API cao&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;MetricName&#34;</span>: <span style="color:#e6db74">&#34;FailedCollections&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Namespace&#34;</span>: <span style="color:#e6db74">&#34;Weather/ETL&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Statistic&#34;</span>: <span style="color:#e6db74">&#34;Sum&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Period&#34;</span>: <span style="color:#ae81ff">1800</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;EvaluationPeriods&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Threshold&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;ComparisonOperator&#34;</span>: <span style="color:#e6db74">&#34;GreaterThanThreshold&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="bước-5-cloudwatch-dashboard">Bước 5: CloudWatch Dashboard</h2>
<h3 id="51-tạo-weather-etl-dashboard">5.1 Tạo Weather ETL Dashboard</h3>
<ol>
<li>
<p><strong>Điều hướng đến CloudWatch Console</strong></p>
<ul>
<li>AWS Console → CloudWatch → Dashboards</li>
<li>Click &ldquo;Create dashboard&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Dashboard Configuration</strong></p>
<ul>
<li><strong>Dashboard Name</strong>: <code>Weather-ETL-Monitoring</code></li>
<li><strong>Description</strong>: &ldquo;Weather data collection monitoring dashboard&rdquo;</li>
</ul>
</li>
</ol>
<h3 id="52-dashboard-widgets">5.2 Dashboard Widgets</h3>
<p><strong>Widget 1: Collection Success Rate</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;metric&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;metrics&#34;</span>: [
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;Weather/ETL&#34;</span>, <span style="color:#e6db74">&#34;SuccessfulCollections&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;Weather/ETL&#34;</span>, <span style="color:#e6db74">&#34;FailedCollections&#34;</span>]
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;period&#34;</span>: <span style="color:#ae81ff">3600</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;stat&#34;</span>: <span style="color:#e6db74">&#34;Sum&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;region&#34;</span>: <span style="color:#e6db74">&#34;us-east-1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;title&#34;</span>: <span style="color:#e6db74">&#34;Tỷ lệ Thu thập Thành công&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;yAxis&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;left&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;min&#34;</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Widget 2: Lambda Performance</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;metric&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;metrics&#34;</span>: [
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;AWS/Lambda&#34;</span>, <span style="color:#e6db74">&#34;Duration&#34;</span>, <span style="color:#e6db74">&#34;FunctionName&#34;</span>, <span style="color:#e6db74">&#34;weather-current-collector&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;AWS/Lambda&#34;</span>, <span style="color:#e6db74">&#34;Duration&#34;</span>, <span style="color:#e6db74">&#34;FunctionName&#34;</span>, <span style="color:#e6db74">&#34;weather-forecast-collector&#34;</span>]
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;period&#34;</span>: <span style="color:#ae81ff">300</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;stat&#34;</span>: <span style="color:#e6db74">&#34;Average&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;region&#34;</span>: <span style="color:#e6db74">&#34;us-east-1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;title&#34;</span>: <span style="color:#e6db74">&#34;Thời gian Thực thi Lambda&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;yAxis&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;left&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;min&#34;</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Widget 3: Error Rate</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;metric&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;metrics&#34;</span>: [
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;AWS/Lambda&#34;</span>, <span style="color:#e6db74">&#34;Errors&#34;</span>, <span style="color:#e6db74">&#34;FunctionName&#34;</span>, <span style="color:#e6db74">&#34;weather-current-collector&#34;</span>],
</span></span><span style="display:flex;"><span>      [<span style="color:#e6db74">&#34;AWS/Lambda&#34;</span>, <span style="color:#e6db74">&#34;Errors&#34;</span>, <span style="color:#e6db74">&#34;FunctionName&#34;</span>, <span style="color:#e6db74">&#34;weather-forecast-collector&#34;</span>]
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;period&#34;</span>: <span style="color:#ae81ff">3600</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;stat&#34;</span>: <span style="color:#e6db74">&#34;Sum&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;region&#34;</span>: <span style="color:#e6db74">&#34;us-east-1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;title&#34;</span>: <span style="color:#e6db74">&#34;Tỷ lệ Lỗi Lambda&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="bước-6-cost-optimization">Bước 6: Cost Optimization</h2>
<h3 id="61-optimized-scheduling-strategy">6.1 Optimized Scheduling Strategy</h3>
<p><strong>Giờ cao điểm vs. Giờ thấp điểm</strong>:</p>
<ul>
<li><strong>Giờ cao điểm</strong> (7:00-22:00 VN): Thu thập mỗi giờ</li>
<li><strong>Giờ thấp điểm</strong> (22:00-7:00 VN): Thu thập mỗi 3 giờ</li>
</ul>
<p><strong>Cron Expression cho Giờ cao điểm</strong>:</p>
<pre tabindex="0"><code>cron(0 0-15 * * ? *)
</code></pre><p><strong>Cron Expression cho Giờ thấp điểm</strong>:</p>
<pre tabindex="0"><code>cron(0 16,19,22 * * ? *)
</code></pre><h3 id="62-regional-data-collection">6.2 Regional Data Collection</h3>
<p><strong>Khu vực Đông Nam Á</strong>:</p>
<pre tabindex="0"><code>cron(0 1,7,13,19 * * ? *)
</code></pre><p><strong>Global Collection (bao gồm multiple regions)</strong>:</p>
<pre tabindex="0"><code>cron(0 0,6,12,18 * * ? *)
</code></pre><h2 id="bước-7-testing-scheduled-execution">Bước 7: Testing Scheduled Execution</h2>
<h3 id="71-verify-rule-execution">7.1 Verify Rule Execution</h3>
<ol>
<li>
<p><strong>Check CloudWatch Events Console</strong></p>
<ul>
<li>AWS Console → CloudWatch → Events → Rules</li>
<li>Verify rules are enabled and showing recent invocations</li>
</ul>
</li>
<li>
<p><strong>Check Lambda Function Metrics</strong></p>
<ul>
<li>AWS Console → Lambda → Functions</li>
<li>Check Invocations và Duration metrics</li>
</ul>
</li>
</ol>
<h3 id="72-manual-rule-testing">7.2 Manual Rule Testing</h3>
<p><strong>Test Current Weather Rule</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aws events put-events --entries Source<span style="color:#f92672">=</span>manual-test,DetailType<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Manual Test&#34;</span>,Detail<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{&#34;test&#34;: true}&#39;</span>
</span></span></code></pre></div><p><strong>Check S3 for New Data</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aws s3 ls s3://weather-data-lake-123456789012/raw/current-weather/ --recursive --human-readable
</span></span></code></pre></div><h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="73-common-issues">7.3 Common Issues</h3>
<p><strong>Rule không trigger</strong>:</p>
<ul>
<li>Kiểm tra IAM permissions cho CloudWatch Events</li>
<li>Verify Lambda function permissions</li>
<li>Check rule state (Enabled/Disabled)</li>
</ul>
<p><strong>Lambda timeout</strong>:</p>
<ul>
<li>Tăng timeout setting (hiện tại: 5 minutes)</li>
<li>Optimize code hoặc giảm số lượng cities</li>
</ul>
<p><strong>API rate limits</strong>:</p>
<ul>
<li>Monitor OpenWeatherMap API usage</li>
<li>Implement exponential backoff</li>
<li>Consider upgrading API plan nếu cần</li>
</ul>
<h2 id="tóm-tắt">Tóm tắt</h2>
<p>Trong phần này, chúng ta đã:</p>
<p>✅ Thiết lập CloudWatch Events rules cho automated scheduling<br>
✅ Cấu hình lịch trình hàng giờ cho current weather<br>
✅ Cấu hình lịch trình 6 giờ/lần cho forecast data<br>
✅ Tạo SNS topic để nhận alerts<br>
✅ Thiết lập CloudWatch alarms và dashboard<br>
✅ Optimize cost với smart scheduling<br>
✅ Test scheduled execution thành công</p>
<p><strong>Tiếp theo</strong>: Trong module 2.4, chúng ta sẽ thiết lập testing và monitoring toàn diện để đảm bảo hệ thống chạy ổn định và đáng tin cậy.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/vi/2-data-collection-openweathermap/2.2-lambda-weather-collector/" title="Xây dựng Lambda Weather Collector"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/vi/2-data-collection-openweathermap/2.4-testing-monitoring/" title="Testing và Monitoring Thu thập Thời tiết" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1752216386"></script>
    <script src="/js/perfect-scrollbar.min.js?1752216386"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1752216386"></script>
    <script src="/js/jquery.sticky.js?1752216386"></script>
    <script src="/js/featherlight.min.js?1752216386"></script>
    <script src="/js/highlight.pack.js?1752216386"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1752216386"></script>
    <script src="/js/learn.js?1752216386"></script>
    <script src="/js/hugo-learn.js?1752216386"></script>

    <link href="/mermaid/mermaid.css?1752216386" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1752216386"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
